{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s]+"},"docs":[{"location":"","text":"SORMAS SORMAS (Surveillance Outbreak Response Management and Analysis System) is an open source eHealth system - consisting of separate web and mobile apps - that is geared towards optimizing the processes used in monitoring the spread of infectious diseases and responding to outbreak situations. FAQ (Frequently Asked Questions) How Does it Work? You can give SORMAS a try on our demo server at https://demoversion.sormas-oegd.de ! How Can I Get Involved? Read through our Contributing Readme and contact us at sormas@helmholtz-hzi.de or join our developer chat on Gitter to learn how you can help to drive the development of SORMAS forward and to get development support from our core developers. SORMAS is a community-driven project, and we'd love to have you on board! If you want to contribute to the code, please strictly adhere to the Development Environment guide to ensure that everything is set up correctly. Please also make sure that you've read the Development Contributing Guidelines before you start to develop, and either follow or regularly check our Twitter account @SORMASDev to stay up to date with our schedule, new releases, guideline changes and other announcements. How Can I Report a Bug or Request a Feature? If you want to report a security issue , please read and follow our Security Policies . For bugs without security implications, change and feature requests, please create a new issue and read the Submitting an Issue guide for more detailed instructions. We appreciate your help! Which Browsers and Android Versions Are Supported? SORMAS officially supports and is tested on Chromium-based browsers (like Google Chrome) and Mozilla Firefox , and all Android versions starting from Android 7.0 (Nougat). In principle, SORMAS should be usable with all web browsers that are supported by Vaadin 8 (Chrome, Firefox, Safari, Edge, Internet Explorer 11; see https://vaadin.com/faq ). Making use of the SORMAS web application through a mobile device web browser is possible and acceptable also in countries that are subject to the General Data Protection Regulation (GDPR) as enforced by the European Union. However, in such countries that are subject to the GDPR, the Android application (.apk file) for SORMAS should not be used on mobile devices until further notice. Is there a ReST API documentation? Yes! Please download the latest release and copy the content of /deploy/openapi/sormas-rest.yaml to an editor that generates a visual API documentation(e.g. https://editor.swagger.io/ ). A runtime Swagger documentation of the External Visits Resource (used by external symptom journals such as CLIMEDO or PIA) is available at <<host>>/sormas-rest/openapi.json or <<host>>/sormas-rest/openapi.yaml Guidelines and Resources If you want to learn more about the development and contribution process, setting up or customizing your own system, or technical details, please consider the following guides and resources available in this repository. You can also view this readme and all guides outside the Wiki with a full table of content and search functionality here: https://hzi-braunschweig.github.io/SORMAS-Project/ GitHub Wiki - Our wiki contains additional guides for server customization and development instructions. Please have a look at it if you need information on anything that this readme does not contain. Contributing Guidelines - These are mandatory literature if you want to contribute to this repository in any way (e.g. by submitting issues, developing code, or translating SORMAS into new languages). Development Environment Setup Instructions - If you want to get involved with development, this guide tells you how to correctly set up your system in order to contribute to the code in adherence with codestyle guidelines, development practices, etc. Troubleshooting - A collection of solutions to common (mostly development) problems. Please consult this readme when encountering issues before issuing a support request. Server Customization - If you are maintaining a SORMAS server or are a developer, this guide explains core concepts such as turning features on or off, importing infrastructure data or adjusting the configuration file. Internationalization - SORMAS can be translated in any language by using the open source tool Crowdin ; this resource explains how this process is working. Disease Definition Instructions - We already support a large number of diseases, but not all of them are fully configured for case-based surveillance, and some might not be part of SORMAS at all yet; if you need SORMAS to support a specific disease, please use these instructions to give us all the information we need in order to extend the software with your requested disease. Security Policies - These contain important information about how to report security problems and the processes we are using to take care of them. 3rd Party License Acknowledgement - This resource contains the names and license copies of external resources that SORMAS is using. If you want to set up a SORMAS instance for production, testing or development purposes, please refer to the following guides: * Installing a SORMAS Server * Installing a SORMAS Server for Development * Updating a SORMAS Server * Creating a Demo Android App Project Structure The project consists of the following modules: sormas-api: General business logic and definitions for data exchange between app and server sormas-app: The Android app sormas-backend: Server entity services, facades, etc. sormas-base: Base project that also contains build scripts sormas-base/dependencies: Dependencies to be deployed with the payara server sormas-cargoserver: Setup for a local dev server using maven-cargo sormas-e2e-performance-tests: Automated performance tests addressing the ReST interface (sormas-rest) sormas-e2e-tests: Automated frontend tests addressing sormas-ui and API tests against sormas-rest. The API steps are partly used to prepare data for UI tests. sormas-ear: The ear needed to build the application sormas-keycloak-service-provider: Custom Keycloak SPI for SORMAS sormas-rest: The REST interface; see sormas-rest/README.md sormas-ui: The web application sormas-widgetset: The GWT widgetset generated by Vaadin sormas-e2e-tests: Automated tests addressing the sormas-ui, and the ReST interface","title":"Home"},{"location":"#sormas","text":"SORMAS (Surveillance Outbreak Response Management and Analysis System) is an open source eHealth system - consisting of separate web and mobile apps - that is geared towards optimizing the processes used in monitoring the spread of infectious diseases and responding to outbreak situations.","title":"SORMAS"},{"location":"#faq-frequently-asked-questions","text":"","title":"FAQ (Frequently Asked Questions)"},{"location":"#how-does-it-work","text":"You can give SORMAS a try on our demo server at https://demoversion.sormas-oegd.de !","title":"How Does it Work?"},{"location":"#how-can-i-get-involved","text":"Read through our Contributing Readme and contact us at sormas@helmholtz-hzi.de or join our developer chat on Gitter to learn how you can help to drive the development of SORMAS forward and to get development support from our core developers. SORMAS is a community-driven project, and we'd love to have you on board! If you want to contribute to the code, please strictly adhere to the Development Environment guide to ensure that everything is set up correctly. Please also make sure that you've read the Development Contributing Guidelines before you start to develop, and either follow or regularly check our Twitter account @SORMASDev to stay up to date with our schedule, new releases, guideline changes and other announcements.","title":"How Can I Get Involved?"},{"location":"#how-can-i-report-a-bug-or-request-a-feature","text":"If you want to report a security issue , please read and follow our Security Policies . For bugs without security implications, change and feature requests, please create a new issue and read the Submitting an Issue guide for more detailed instructions. We appreciate your help!","title":"How Can I Report a Bug or Request a Feature?"},{"location":"#which-browsers-and-android-versions-are-supported","text":"SORMAS officially supports and is tested on Chromium-based browsers (like Google Chrome) and Mozilla Firefox , and all Android versions starting from Android 7.0 (Nougat). In principle, SORMAS should be usable with all web browsers that are supported by Vaadin 8 (Chrome, Firefox, Safari, Edge, Internet Explorer 11; see https://vaadin.com/faq ). Making use of the SORMAS web application through a mobile device web browser is possible and acceptable also in countries that are subject to the General Data Protection Regulation (GDPR) as enforced by the European Union. However, in such countries that are subject to the GDPR, the Android application (.apk file) for SORMAS should not be used on mobile devices until further notice.","title":"Which Browsers and Android Versions Are Supported?"},{"location":"#is-there-a-rest-api-documentation","text":"Yes! Please download the latest release and copy the content of /deploy/openapi/sormas-rest.yaml to an editor that generates a visual API documentation(e.g. https://editor.swagger.io/ ). A runtime Swagger documentation of the External Visits Resource (used by external symptom journals such as CLIMEDO or PIA) is available at <<host>>/sormas-rest/openapi.json or <<host>>/sormas-rest/openapi.yaml","title":"Is there a ReST API documentation?"},{"location":"#guidelines-and-resources","text":"If you want to learn more about the development and contribution process, setting up or customizing your own system, or technical details, please consider the following guides and resources available in this repository. You can also view this readme and all guides outside the Wiki with a full table of content and search functionality here: https://hzi-braunschweig.github.io/SORMAS-Project/ GitHub Wiki - Our wiki contains additional guides for server customization and development instructions. Please have a look at it if you need information on anything that this readme does not contain. Contributing Guidelines - These are mandatory literature if you want to contribute to this repository in any way (e.g. by submitting issues, developing code, or translating SORMAS into new languages). Development Environment Setup Instructions - If you want to get involved with development, this guide tells you how to correctly set up your system in order to contribute to the code in adherence with codestyle guidelines, development practices, etc. Troubleshooting - A collection of solutions to common (mostly development) problems. Please consult this readme when encountering issues before issuing a support request. Server Customization - If you are maintaining a SORMAS server or are a developer, this guide explains core concepts such as turning features on or off, importing infrastructure data or adjusting the configuration file. Internationalization - SORMAS can be translated in any language by using the open source tool Crowdin ; this resource explains how this process is working. Disease Definition Instructions - We already support a large number of diseases, but not all of them are fully configured for case-based surveillance, and some might not be part of SORMAS at all yet; if you need SORMAS to support a specific disease, please use these instructions to give us all the information we need in order to extend the software with your requested disease. Security Policies - These contain important information about how to report security problems and the processes we are using to take care of them. 3rd Party License Acknowledgement - This resource contains the names and license copies of external resources that SORMAS is using. If you want to set up a SORMAS instance for production, testing or development purposes, please refer to the following guides: * Installing a SORMAS Server * Installing a SORMAS Server for Development * Updating a SORMAS Server * Creating a Demo Android App","title":"Guidelines and Resources"},{"location":"#project-structure","text":"The project consists of the following modules: sormas-api: General business logic and definitions for data exchange between app and server sormas-app: The Android app sormas-backend: Server entity services, facades, etc. sormas-base: Base project that also contains build scripts sormas-base/dependencies: Dependencies to be deployed with the payara server sormas-cargoserver: Setup for a local dev server using maven-cargo sormas-e2e-performance-tests: Automated performance tests addressing the ReST interface (sormas-rest) sormas-e2e-tests: Automated frontend tests addressing sormas-ui and API tests against sormas-rest. The API steps are partly used to prepare data for UI tests. sormas-ear: The ear needed to build the application sormas-keycloak-service-provider: Custom Keycloak SPI for SORMAS sormas-rest: The REST interface; see sormas-rest/README.md sormas-ui: The web application sormas-widgetset: The GWT widgetset generated by Vaadin sormas-e2e-tests: Automated tests addressing the sormas-ui, and the ReST interface","title":"Project Structure"},{"location":"3RD_PARTY_ACK/","text":"3rd Party License Acknowledgement Country flags in sormas-ui/src/main/webapp/VAADIN/themes/sormas/img/flag-icons/ are licensed under MIT: Copyright (c) 2017 Go Squared Ltd. http://www.gosquared.com/ Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.","title":"Acknowledgements"},{"location":"3RD_PARTY_ACK/#3rd-party-license-acknowledgement","text":"Country flags in sormas-ui/src/main/webapp/VAADIN/themes/sormas/img/flag-icons/ are licensed under MIT: Copyright (c) 2017 Go Squared Ltd. http://www.gosquared.com/ Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.","title":"3rd Party License Acknowledgement"},{"location":"ADDING_LICENSE/","text":"Adding License Headers License Header Use the following header for all newly created source files: SORMAS\u00ae - Surveillance Outbreak Response Management & Analysis System Copyright \u00a9 2016-2021 Helmholtz-Zentrum f\u00fcr Infektionsforschung GmbH (HZI) This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with this program. If not, see <https://www.gnu.org/licenses/>. Eclipse Use eclipse's Releng tool to automatically add license headers to all relevant source files (see here for a usage guide) After installing the tool from the marketplace, open Window > Preferences > Copyright Tool and paste the license header from above into the template text area Make sure to select \"Replace all existing copyright comments with this copyright template\" and especially \"Skip over XML files\" (to make sure that headers don't get added to e.g. build files) Whenever you create a new source file: Right click on the file and select \"Fix Copyrights\" Android Studio/IntelliJ Open File > Settings > Editor > Copyright > Copyright Profiles Create a new profile and paste the license header from above into the Copyright text area Head back to the general Copyright settings and select the new copyright profile as the \"Default project copyright\" (Optional: If the year has changed, right click on all projects containing manual code and select \"Update Copyright...\", select \"Custom Scope\" and in the dropdown, select \"Project Source Files\"; Click \"Ok\" and wait until the copyright has been added to/changed for all files) Android Studio automatically adds the copyright to newly created files afterwards","title":"Licensing"},{"location":"ADDING_LICENSE/#adding-license-headers","text":"","title":"Adding License Headers"},{"location":"ADDING_LICENSE/#license-header","text":"Use the following header for all newly created source files: SORMAS\u00ae - Surveillance Outbreak Response Management & Analysis System Copyright \u00a9 2016-2021 Helmholtz-Zentrum f\u00fcr Infektionsforschung GmbH (HZI) This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with this program. If not, see <https://www.gnu.org/licenses/>.","title":"License Header"},{"location":"ADDING_LICENSE/#eclipse","text":"Use eclipse's Releng tool to automatically add license headers to all relevant source files (see here for a usage guide) After installing the tool from the marketplace, open Window > Preferences > Copyright Tool and paste the license header from above into the template text area Make sure to select \"Replace all existing copyright comments with this copyright template\" and especially \"Skip over XML files\" (to make sure that headers don't get added to e.g. build files) Whenever you create a new source file: Right click on the file and select \"Fix Copyrights\"","title":"Eclipse"},{"location":"ADDING_LICENSE/#android-studiointellij","text":"Open File > Settings > Editor > Copyright > Copyright Profiles Create a new profile and paste the license header from above into the Copyright text area Head back to the general Copyright settings and select the new copyright profile as the \"Default project copyright\" (Optional: If the year has changed, right click on all projects containing manual code and select \"Update Copyright...\", select \"Custom Scope\" and in the dropdown, select \"Project Source Files\"; Click \"Ok\" and wait until the copyright has been added to/changed for all files) Android Studio automatically adds the copyright to newly created files afterwards","title":"Android Studio/IntelliJ"},{"location":"CONTRIBUTING/","text":"Contributing Guidelines If you want to contribute to SORMAS by any means - for example by submitting a bug report, requesting a new feature, translating the application into a new language, or actively contributing to the source code -, please make sure to read through and follow these guidelines. This allows us to consider and process your contribution as quickly and smoothly as possible. If there is anything unclear to you or you think that this guide is lacking coverage of a specific topic, please create a support issue or get in touch with us via Gitter . Table of Contents Submitting an Issue Bug Report Change Request Feature Request Support Request Contributing to the Project Contributing to the Code Development Contributing Guidelines Picking Issues for Development Submitting Pull Requests Submitting an Issue Before creating a new issue, please search the repository for similar issues first to avoid duplicates! You can do this by using the search field in the menu bar. If you find an issue that already covers your request or seems very similar, please comment on that issue. Please make sure to always use one of the templates that are automatically presented to you when creating a new issue because it ensures that your issue is structured and ideally contains all the information that we need. Please add information to every mandatory section of the issue templates, and try to fill in the optional sections if possible. Please note that we might have to close issues that are not created this way. If you want to report a security issue , please follow our guidelines for Responsible Disclosure . Bug Report Bug reports cover everything that leads to the application behaving in an unintended way, including crashes, unexpected error messages, data loss, etc. If something seems to be working correctly but does not necessarily match your expectations of how it should be working, please consider opening a change request instead. Bug Description: A description of what exactly happened, where it happened and under which circumstances. Provide as many details as possible, even if they might seem irrelevant to you. Steps to Reproduce: If possible, provide a step-by-step instruction on the order of actions you performed before the bug occurred. This helps us to reproduce it on our system. Generally optional , but likely necessary for more complex bugs. Expected Behavior: Quickly describe what you believe should have happened instead of the error you got. Optional when the error is identified by a crash or an error message, but likely necessary if the bug is the result of a misbehavior of the application. Screenshots: If possible, make at least one screenshot of the bug and include it in your bug report. You can do this by simply dragging-and-dropping the image file into the template you're filling out. Optional , but very helpful for us. System Details: Tell us which device you were using, on which SORMAS version the error occurred and, depending on whether you were using the mobile app or the web app, your Android version or web browser. Additional Information: If there is anything else you want to add to your request, you can put it here. Optional . Change Request Change requests cover features that are already part of SORMAS. This primarily includes aspects (or whole features) for which you would like to request an altered behavior, but also small extensions (e.g. additional values being added to a dropdown field). Feature Description: Please describe the feature you would like us to change like it is in SORMAS right now. If it is about a relatively big or a very general feature, naming it briefly might be enough. If it is about a very specific detail of said feature, please try to be more specific. Problem Description: Tell us why you want us to change the feature and what you believe is wrong or could be improved about the way it is currently designed. Proposed Change: Describe in as much detail as possible how you would like us to change the feature and what the expected outcome of your request should look like. Possible Alternatives: If possible, provide alternative solutions in case your proposed change can not be implemented for any reason. This is generally optional but might be requested at a later point in time. Additional Information: If there is anything else you want to add to your request, you can put it here. Optional . Feature Request These types of issue cover everything that involves adding new features to SORMAS. This includes both very large additions like completely new app sections, but also smaller ones like adding a new field to an existing form. Situation Description: Please describe why your proposed feature is required, why SORMAS in its current state is not able to do what you want it to do, and in which way it would benefit from your feature being implemented. Feature Description: Describe in as much detail as possible how your proposed feature should look like and what it should do. Possible Alternatives: If possible, provide alternative solutions in case your proposed feature can not be implemented in the way you outlined it for any reason. This is generally optional but might be requested at a later point in time. Additional Information: If there is anything else you want to add to your request, you can put it here. Optional . Task A task that needs to be done but does not directly change anything about the product. This could for example be the preparation of an upcoming feature/change, optimization of processes on GitHub, or update of one of the guides or Wiki articles in this repository. Problem Description: Please describe the requirement or problem that is supposed to be solved. Proposed Solution: Describe in as much detail how the proposed solution should look like and what should be done in order to achieve it. Possible Alternatives: If possible, provide alternative solutions in case your proposed change can not be realized for any reason. This is generally optional but might be requested at a later point in time. Additional Information: If there is anything else you want to add to the task, you can put it here. Optional . Support Request If you have problems setting up a SORMAS server or your development environment, don't know how a specific functionality in SORMAS is supposed to work, or have any other request that is not directly associated with a bug report, change or feature request, a support request is likely the correct type of issue for your concern. Alternatively, you can join our Gitter channel and ask your question over there which might potentially give you a quicker and more comfortable way to talk about your request. If your request is about a specific problem, please make sure to provide as much information as possible. Contributing to the Project There are a lot of ways in which you can contribute to this project as a non-developer. If there is something you would like to do that you don't find instructions about here - or if you want to learn how you can get involved - please contact us at sormas@helmholtz-hzi.de and let us know how we can assist you! Some possibilities to contribute to SORMAS are: Helping with translation Defining new diseases Contributing to the Code If you're interested in participating in the development of SORMAS, please follow the Development Environment Setup Instructions before you start developing. If you have problems setting up your development environment or need assistance in choosing the first issue to work on, please get in touch with us by joining our Gitter channel or contacting us at sormas@helmholtz-hzi.de. Additionally, our Wiki contains some specific development guides that cover common issues like adding new fields to an entity that we suggest to check out before you start implementing something related to those topics. Development Contributing Guidelines In addition to the guidelines covered in the Development Environment Setup Instructions, please ensure to adhere to the following principles and procedures while developing code for SORMAS: Remember to always apply code formatting and import reordering for all classes you work on; we recommend to use the Save Actions plugin as described in the setup instructions instead of manually executing these steps. Some code formatting rules can't be enforced by the code formatter. Please make sure to write your code in accordance to the following rules: When defining a method, enter a blank line before starting to write its body (except for methods with only one line of code, e.g. most getters and setters). Use a blank line to separate logical blocks of code within a method. Apart from those, don't use blank lines where they are not necessarily needed to keep the code compact and readable. Don't use blank lines after the last statement of a block, but a closing } with proper indentation in the next line instead. Don't use blank lines between two closing } . You can use //@formatter:off and //@formatter:on to encapsulate code blocks that you don't want automatic code formatting to be applied to, e.g. because it would mess up readability. Please only use this if really needed and try to use proper indentation nonetheless. Separate code and comments, i.e. write the comment in a separate line before the statement that you want to explain. When you create new classes, please add license headers to them according to the Adding License Headers guide Commit messages have to be related to a specific issue on GitHub and reference its issue number as well as include a short description on what has been done in the commit. We might reject pull requests that violate this principle and ask you to re-submit it with proper commit messages. An acceptable commit message could look like this: 61 - added model to define classification, apply automatic case classification whenever a field value changes Picking Issues for Development When picking tasks for development, you can either search the repository for existing issues that you would like to work on, or you can submit your own issues if you don't find any that cover your topic of interest (see the \"Submitting an Issue\" section of this guide). While it is not mandatory, we heavily suggest to mark issues that you want to work on with the approval requested label and wait for one of the core developers to respond to the issue in one of the following ways. If you didn't create the issue yourself but picked an existing one, please also add a comment to indicate that you would like to work on it. The developer might request clarification concerning the specifications of the issue; please try to to answer their questions or extend the issue description and wait for their feedback. The developer might suggest changes to the functional or technical specifications to ensure that it fits the overall vision of the application; please confirm these suggestions or discuss them with the developer if you don't agree with them. The developer might approve the issue by adding an approval comment and removing the approval requested label. This means that we believe that the specifications are complete and the purpose of the issue serves the overall vision of SORMAS. At this point you can start development on the issue. The developer might ask you to pick another issue for development. This will usually only happen if the issue you have requested approval for is already planned to be developed by the core development team for the current or next milestone. The developer might reject the issue altogether. This will usually only happen if it doesn't fit the overall vision of the application at all or is a duplicate, and most of the time we will discuss this with you before closing the issue. The advantage of adhering to this process is that you can be sure that there won't be any major change requests in terms of functional or technical specifications once you've submitted a pull request containing your work, and that discussions concerning these topics can be led and finished before starting development. If you have labeled an issue with approval requested but don't receive any feedback on it for a few days, please add a comment that directly tags @MateStrysewske , @MartinWahnschaffe or @markusmann-vg . Submitting Pull Requests Contributing to the SORMAS code requires you to submit pull requests that will be reviewed by one of our core developers. Once a pull request has been submitted to our repository, a developer will either assign themselves as its reviewer or we will get back to you in case we won't be able to review it in time. This may e.g. happen if your pull request involves a lot of technical changes that we would like to merge together with other issues of the same nature or that could potentially break a lot of logic. Usually though, the general process looks like this: A developer assigns themselves as the reviewer of your pull request. Please wait until the review is done; if you think that the review is taking too long, feel free to add a comment to the pull request as a reminder to the developer. The developer might request changes to the code. If that's the case, please implement the requested changes or answer to their change request if you have questions or don't agree with a specific part of the request. Once you've implemented all requested changes, please request another review by the assigned developer by clicking on the \"Re-request review\" icon next to their name. As soon as the developer is happy with the submitted code (which might require multiple iterations of step 2 and 3, especially for larger pull requests), they will merge it into the development branch and close the pull request. Please adhere to the following principles when submitting pull requests: Only submit pull requests that are directly associated with ideally one specific issue in our GitHub repository. If there is no issue for the development work that you would like to do, create one before you start working on it. Link your pull request to the issue(s) that they are associated with. This can be done either by using the \"Linked issues\" section at the right side when viewing a pull request, or by adding the keyword \"Closes\" or \"Fixes\" followed by the issue number to the pull request description (e.g. \"Closes #61\"). Make sure that your pull request has a meaningful title. By default, GitHub will use your commit message as the title which might not be appropriate. In general, using the same name as the linked issue is a good rule of thumb. Try to not use force-push when updating an existing pull request (e.g. after changes have been requested or because you need to resolve merge conflicts). Ideally, your pull request should pass the checks done by the automatic CI pipeline before it gets reviewed. If that's not the case, please make sure that your branch is up-to-date with the current development branch. If the checks also fail for the development branch, you're not required to do anything. In any other case, please fix the issues (most likely failed unit tests) before requesting another review.","title":"Contributing"},{"location":"CONTRIBUTING/#contributing-guidelines","text":"If you want to contribute to SORMAS by any means - for example by submitting a bug report, requesting a new feature, translating the application into a new language, or actively contributing to the source code -, please make sure to read through and follow these guidelines. This allows us to consider and process your contribution as quickly and smoothly as possible. If there is anything unclear to you or you think that this guide is lacking coverage of a specific topic, please create a support issue or get in touch with us via Gitter .","title":"Contributing Guidelines"},{"location":"CONTRIBUTING/#table-of-contents","text":"Submitting an Issue Bug Report Change Request Feature Request Support Request Contributing to the Project Contributing to the Code Development Contributing Guidelines Picking Issues for Development Submitting Pull Requests","title":"Table of Contents"},{"location":"CONTRIBUTING/#submitting-an-issue","text":"Before creating a new issue, please search the repository for similar issues first to avoid duplicates! You can do this by using the search field in the menu bar. If you find an issue that already covers your request or seems very similar, please comment on that issue. Please make sure to always use one of the templates that are automatically presented to you when creating a new issue because it ensures that your issue is structured and ideally contains all the information that we need. Please add information to every mandatory section of the issue templates, and try to fill in the optional sections if possible. Please note that we might have to close issues that are not created this way. If you want to report a security issue , please follow our guidelines for Responsible Disclosure .","title":"Submitting an Issue"},{"location":"CONTRIBUTING/#bug-report","text":"Bug reports cover everything that leads to the application behaving in an unintended way, including crashes, unexpected error messages, data loss, etc. If something seems to be working correctly but does not necessarily match your expectations of how it should be working, please consider opening a change request instead. Bug Description: A description of what exactly happened, where it happened and under which circumstances. Provide as many details as possible, even if they might seem irrelevant to you. Steps to Reproduce: If possible, provide a step-by-step instruction on the order of actions you performed before the bug occurred. This helps us to reproduce it on our system. Generally optional , but likely necessary for more complex bugs. Expected Behavior: Quickly describe what you believe should have happened instead of the error you got. Optional when the error is identified by a crash or an error message, but likely necessary if the bug is the result of a misbehavior of the application. Screenshots: If possible, make at least one screenshot of the bug and include it in your bug report. You can do this by simply dragging-and-dropping the image file into the template you're filling out. Optional , but very helpful for us. System Details: Tell us which device you were using, on which SORMAS version the error occurred and, depending on whether you were using the mobile app or the web app, your Android version or web browser. Additional Information: If there is anything else you want to add to your request, you can put it here. Optional .","title":"Bug Report"},{"location":"CONTRIBUTING/#change-request","text":"Change requests cover features that are already part of SORMAS. This primarily includes aspects (or whole features) for which you would like to request an altered behavior, but also small extensions (e.g. additional values being added to a dropdown field). Feature Description: Please describe the feature you would like us to change like it is in SORMAS right now. If it is about a relatively big or a very general feature, naming it briefly might be enough. If it is about a very specific detail of said feature, please try to be more specific. Problem Description: Tell us why you want us to change the feature and what you believe is wrong or could be improved about the way it is currently designed. Proposed Change: Describe in as much detail as possible how you would like us to change the feature and what the expected outcome of your request should look like. Possible Alternatives: If possible, provide alternative solutions in case your proposed change can not be implemented for any reason. This is generally optional but might be requested at a later point in time. Additional Information: If there is anything else you want to add to your request, you can put it here. Optional .","title":"Change Request"},{"location":"CONTRIBUTING/#feature-request","text":"These types of issue cover everything that involves adding new features to SORMAS. This includes both very large additions like completely new app sections, but also smaller ones like adding a new field to an existing form. Situation Description: Please describe why your proposed feature is required, why SORMAS in its current state is not able to do what you want it to do, and in which way it would benefit from your feature being implemented. Feature Description: Describe in as much detail as possible how your proposed feature should look like and what it should do. Possible Alternatives: If possible, provide alternative solutions in case your proposed feature can not be implemented in the way you outlined it for any reason. This is generally optional but might be requested at a later point in time. Additional Information: If there is anything else you want to add to your request, you can put it here. Optional .","title":"Feature Request"},{"location":"CONTRIBUTING/#task","text":"A task that needs to be done but does not directly change anything about the product. This could for example be the preparation of an upcoming feature/change, optimization of processes on GitHub, or update of one of the guides or Wiki articles in this repository. Problem Description: Please describe the requirement or problem that is supposed to be solved. Proposed Solution: Describe in as much detail how the proposed solution should look like and what should be done in order to achieve it. Possible Alternatives: If possible, provide alternative solutions in case your proposed change can not be realized for any reason. This is generally optional but might be requested at a later point in time. Additional Information: If there is anything else you want to add to the task, you can put it here. Optional .","title":"Task"},{"location":"CONTRIBUTING/#support-request","text":"If you have problems setting up a SORMAS server or your development environment, don't know how a specific functionality in SORMAS is supposed to work, or have any other request that is not directly associated with a bug report, change or feature request, a support request is likely the correct type of issue for your concern. Alternatively, you can join our Gitter channel and ask your question over there which might potentially give you a quicker and more comfortable way to talk about your request. If your request is about a specific problem, please make sure to provide as much information as possible.","title":"Support Request"},{"location":"CONTRIBUTING/#contributing-to-the-project","text":"There are a lot of ways in which you can contribute to this project as a non-developer. If there is something you would like to do that you don't find instructions about here - or if you want to learn how you can get involved - please contact us at sormas@helmholtz-hzi.de and let us know how we can assist you! Some possibilities to contribute to SORMAS are: Helping with translation Defining new diseases","title":"Contributing to the Project"},{"location":"CONTRIBUTING/#contributing-to-the-code","text":"If you're interested in participating in the development of SORMAS, please follow the Development Environment Setup Instructions before you start developing. If you have problems setting up your development environment or need assistance in choosing the first issue to work on, please get in touch with us by joining our Gitter channel or contacting us at sormas@helmholtz-hzi.de. Additionally, our Wiki contains some specific development guides that cover common issues like adding new fields to an entity that we suggest to check out before you start implementing something related to those topics.","title":"Contributing to the Code"},{"location":"CONTRIBUTING/#development-contributing-guidelines","text":"In addition to the guidelines covered in the Development Environment Setup Instructions, please ensure to adhere to the following principles and procedures while developing code for SORMAS: Remember to always apply code formatting and import reordering for all classes you work on; we recommend to use the Save Actions plugin as described in the setup instructions instead of manually executing these steps. Some code formatting rules can't be enforced by the code formatter. Please make sure to write your code in accordance to the following rules: When defining a method, enter a blank line before starting to write its body (except for methods with only one line of code, e.g. most getters and setters). Use a blank line to separate logical blocks of code within a method. Apart from those, don't use blank lines where they are not necessarily needed to keep the code compact and readable. Don't use blank lines after the last statement of a block, but a closing } with proper indentation in the next line instead. Don't use blank lines between two closing } . You can use //@formatter:off and //@formatter:on to encapsulate code blocks that you don't want automatic code formatting to be applied to, e.g. because it would mess up readability. Please only use this if really needed and try to use proper indentation nonetheless. Separate code and comments, i.e. write the comment in a separate line before the statement that you want to explain. When you create new classes, please add license headers to them according to the Adding License Headers guide Commit messages have to be related to a specific issue on GitHub and reference its issue number as well as include a short description on what has been done in the commit. We might reject pull requests that violate this principle and ask you to re-submit it with proper commit messages. An acceptable commit message could look like this:","title":"Development Contributing Guidelines"},{"location":"CONTRIBUTING/#61-added-model-to-define-classification-apply-automatic-case-classification-whenever-a-field-value-changes","text":"","title":"61 - added model to define classification, apply automatic case classification whenever a field value changes"},{"location":"CONTRIBUTING/#picking-issues-for-development","text":"When picking tasks for development, you can either search the repository for existing issues that you would like to work on, or you can submit your own issues if you don't find any that cover your topic of interest (see the \"Submitting an Issue\" section of this guide). While it is not mandatory, we heavily suggest to mark issues that you want to work on with the approval requested label and wait for one of the core developers to respond to the issue in one of the following ways. If you didn't create the issue yourself but picked an existing one, please also add a comment to indicate that you would like to work on it. The developer might request clarification concerning the specifications of the issue; please try to to answer their questions or extend the issue description and wait for their feedback. The developer might suggest changes to the functional or technical specifications to ensure that it fits the overall vision of the application; please confirm these suggestions or discuss them with the developer if you don't agree with them. The developer might approve the issue by adding an approval comment and removing the approval requested label. This means that we believe that the specifications are complete and the purpose of the issue serves the overall vision of SORMAS. At this point you can start development on the issue. The developer might ask you to pick another issue for development. This will usually only happen if the issue you have requested approval for is already planned to be developed by the core development team for the current or next milestone. The developer might reject the issue altogether. This will usually only happen if it doesn't fit the overall vision of the application at all or is a duplicate, and most of the time we will discuss this with you before closing the issue. The advantage of adhering to this process is that you can be sure that there won't be any major change requests in terms of functional or technical specifications once you've submitted a pull request containing your work, and that discussions concerning these topics can be led and finished before starting development. If you have labeled an issue with approval requested but don't receive any feedback on it for a few days, please add a comment that directly tags @MateStrysewske , @MartinWahnschaffe or @markusmann-vg .","title":"Picking Issues for Development"},{"location":"CONTRIBUTING/#submitting-pull-requests","text":"Contributing to the SORMAS code requires you to submit pull requests that will be reviewed by one of our core developers. Once a pull request has been submitted to our repository, a developer will either assign themselves as its reviewer or we will get back to you in case we won't be able to review it in time. This may e.g. happen if your pull request involves a lot of technical changes that we would like to merge together with other issues of the same nature or that could potentially break a lot of logic. Usually though, the general process looks like this: A developer assigns themselves as the reviewer of your pull request. Please wait until the review is done; if you think that the review is taking too long, feel free to add a comment to the pull request as a reminder to the developer. The developer might request changes to the code. If that's the case, please implement the requested changes or answer to their change request if you have questions or don't agree with a specific part of the request. Once you've implemented all requested changes, please request another review by the assigned developer by clicking on the \"Re-request review\" icon next to their name. As soon as the developer is happy with the submitted code (which might require multiple iterations of step 2 and 3, especially for larger pull requests), they will merge it into the development branch and close the pull request. Please adhere to the following principles when submitting pull requests: Only submit pull requests that are directly associated with ideally one specific issue in our GitHub repository. If there is no issue for the development work that you would like to do, create one before you start working on it. Link your pull request to the issue(s) that they are associated with. This can be done either by using the \"Linked issues\" section at the right side when viewing a pull request, or by adding the keyword \"Closes\" or \"Fixes\" followed by the issue number to the pull request description (e.g. \"Closes #61\"). Make sure that your pull request has a meaningful title. By default, GitHub will use your commit message as the title which might not be appropriate. In general, using the same name as the linked issue is a good rule of thumb. Try to not use force-push when updating an existing pull request (e.g. after changes have been requested or because you need to resolve merge conflicts). Ideally, your pull request should pass the checks done by the automatic CI pipeline before it gets reviewed. If that's not the case, please make sure that your branch is up-to-date with the current development branch. If the checks also fail for the development branch, you're not required to do anything. In any other case, please fix the issues (most likely failed unit tests) before requesting another review.","title":"Submitting Pull Requests"},{"location":"DEMO_APP/","text":"Creating a demo app for a SORMAS demo server Important : This only applies if you have setup your own SORMAS server for demo purposes and and want to give users easy access to it. Step 1: Adjust the sormas-app.properties Open the the apk file from the SORMAS release with a zip editor (e.g. 7zip). Extract sormas-app.properties and open the the file for editing. Set server.url.default to the URL of your SORMAS server's ReST interface. Set user.name.default and user.password.default to the demo user (needs to be an informant or officer). Overwrite the sormas-app.properties in the apk with your changed version. Step 2: Sign the changed apk file Since the apk file has been changed it needs to be signed again.\\ Important : When you change and sign the apk file it is no longer compatible with the original apk file for automatic app update! If you still want to make this work you always have to sign new versions using the same keystore and put the changed apk-file into your SORMAS server for automatic app update.\\ Create a keystore using keytool: keytool -genkey -v -keystore my-demo-key.jks -keyalg RSA -keysize 2048 -validity 10000 -alias my-alias Note: keytool is located in the bin/ directory in your JDK. To locate your JDK from Android Studio, select File > Project Structure, and then click SDK Location and you will see the JDK location. Download uber-apk-signer: https://github.com/patrickfav/uber-apk-signer/releases. Note: this is the convenient way to do it. You can also get an Android SDK and follow the instructions given here Sign the apk file: java -jar uber-apk-signer.jar --ks my-demo-key.jks -ksAlias my-alias --allowResign --apks sormas-version-demo.apk See also: https://github.com/patrickfav/uber-apk-signer#command-line-interface","title":"Demo App"},{"location":"DEMO_APP/#creating-a-demo-app-for-a-sormas-demo-server","text":"Important : This only applies if you have setup your own SORMAS server for demo purposes and and want to give users easy access to it.","title":"Creating a demo app for a SORMAS demo server"},{"location":"DEMO_APP/#step-1-adjust-the-sormas-appproperties","text":"Open the the apk file from the SORMAS release with a zip editor (e.g. 7zip). Extract sormas-app.properties and open the the file for editing. Set server.url.default to the URL of your SORMAS server's ReST interface. Set user.name.default and user.password.default to the demo user (needs to be an informant or officer). Overwrite the sormas-app.properties in the apk with your changed version.","title":"Step 1: Adjust the sormas-app.properties"},{"location":"DEMO_APP/#step-2-sign-the-changed-apk-file","text":"Since the apk file has been changed it needs to be signed again.\\ Important : When you change and sign the apk file it is no longer compatible with the original apk file for automatic app update! If you still want to make this work you always have to sign new versions using the same keystore and put the changed apk-file into your SORMAS server for automatic app update.\\ Create a keystore using keytool: keytool -genkey -v -keystore my-demo-key.jks -keyalg RSA -keysize 2048 -validity 10000 -alias my-alias Note: keytool is located in the bin/ directory in your JDK. To locate your JDK from Android Studio, select File > Project Structure, and then click SDK Location and you will see the JDK location. Download uber-apk-signer: https://github.com/patrickfav/uber-apk-signer/releases. Note: this is the convenient way to do it. You can also get an Android SDK and follow the instructions given here Sign the apk file: java -jar uber-apk-signer.jar --ks my-demo-key.jks -ksAlias my-alias --allowResign --apks sormas-version-demo.apk See also: https://github.com/patrickfav/uber-apk-signer#command-line-interface","title":"Step 2: Sign the changed apk file"},{"location":"DEVELOPMENT_ENVIRONMENT/","text":"Development Environment Setup This step-by-step guide explains how to set up your development environment, using either Eclipse or IntelliJ for the backend and web UI and Android Studio for the mobile app. Please follow it strictly to make sure that development will run as smoothly as possible and your code adheres to our guidelines. Please note that these instructions are optimized for Windows and Linux systems. If you're developing on a Mac and, we would be glad to get your feedback about how this guide can be extended with OS-specific instructions in our developer chat on Gitter . Step 1: Install a Local SORMAS Server Please follow the Server Setup Instructions to set up a local SORMAS instance that you will use to test your code. Alternatively, you can also use Maven Cargo , or a Docker installation (not recommended at this time). Step 2: Check Out the SORMAS Repository Download and install the latest Git version for your operating system Optional: Install a Git client such as TortoiseGit or GitHub Desktop if you don't want to handle version control from the command line or within your IDE Optional: Clone the SORMAS-Project repository with git clone https://github.com/hzi-braunschweig/SORMAS-Project.git ; if you want to use Git from within your IDE, you can also clone the repository in Step 4 Open Git Bash and execute the following command to ensure that rebase is used when pulling the development branch rather than merge: git config --global branch.development.rebase true Step 3: Install Java Download and install the Java 11 JDK (not JRE) for your operating system. We suggest using Zulu OpenJDK . If you're running Linux, please refer to the official documentation on how to install Zulu OpenJDK on your system. If you plan to work on the Android App as well, you will also need the Java 8 JDK to use with Android Studio. Step 4: Install and Configure Your IDE IntelliJ Download and install the latest IntelliJ IDEA Ultimate ; (newer than version of 2020-04-15 to enable debugging, see https://youtrack.jetbrains.com/issue/IDEA-216528 ) Set the project SDK to the installed JDK Optional: Clone the SORMAS-Project repository if you haven't done so already Open the project in IntelliJ. Make sure the project is recognized by IntelliJ as a maven project ; if not, right-click the pom.xml file in sormas-base and select Add as maven project . Make sure that under File -> Project Structure -> Modules all modules EXCEPT sormas-app are recognized; if not, add the missing modules with the + button Navigate to File -> Settings -> Plugins and make sure that Glassfish & Ant integrations are enabled Install the Vaadin 6-8 plugin ; the commercial Vaadin Designer is not needed Make a copy of sormas-base/build.properties.example , rename it to build.properties and set glassfish.domain.root to the location of the SORMAS domain inside your Payara installation Run mvn install on the sormas-base project (e.g. by opening the Maven view and executing sormas-base -> Lifecycle -> install ) Add a Payara server to IntelliJ: Open Run -> Edit Configurations , add a new configuration and choose the Glassfish server template Click on Configure next to Application server and create a new server configuration by selecting your Payara installation directory Check the After launch checkbox and specify the browser that you want SORMAS to open in once the server has been deployed Enter http://localhost:6080/sormas-ui into the URL field Make sure that the correct JRE is specified (your Java 11 JDK) Enter the path to the SORMAS domain and the credentials that you've specified when setting up the server Open the Deployment tab and add the artifacts sormas-ear , sormas-rest and sormas-ui Open the Logs tab and add a new log file pointing to the logs/server.log file in your SORMAS domain Open the Startup/Connection tab and make sure that Pass environment variables is NOT checked; ignore warnings about the debug configuration not being correct Open the config/domain.xml file in your domain directory and make sure that the java-config node contains the following code: <java-config classpath-suffix=\"\" debug-enabled=\"true\" debug-options=\"-agentlib:jdwp=transport=dt_socket,address=6009,server=n,suspend=y\" ... Open the Ant window, click on the + icon and select the sormas-base/build.xml file Execute the install and deploy-serverlibs Ant scripts Set the default working directory for run configurations by navigating to Run -> Edit Configurations -> Templates -> Application and setting Working directory to $MODULE_WORKING_DIR$ Known issues The first time you build the project in IntelliJ, you have to switch the java compiler to \"Eclipse\" to workarround a dependency resolution problem in sormas-api. Eclipse Download and install the latest Eclipse IDE for Enterprise Java and Web Developers Set the default JRE of Eclipse to the installed JDK: Assigning the default JRE for the workbench Optional: Clone the SORMAS-Project repository if you haven't done so already via File -> Import -> Git -> Projects from Git and cancel the process when you're asked to create a new project from the cloned repository Import the projects from the SORMAS-Project repository into your workspace via File -> Import -> Maven -> Existing Maven Projects Install the Payara Tools plugin Install the Vaadin Plugin for Eclipse ; the commercial UI designer is not needed Add a Payara server to Eclipse and enter the credentials you specified when setting up the local SORMAS server Make a copy of sormas-base/build.properties.example , rename it to build.properties and set glassfish.domain.root to the location of the SORMAS domain inside your Payara installation Drag the sormas-base/build.xml file into the Ant view in Eclipse Either run mvn install on the sormas-base project or execute the install [default] Ant script (this needs a Maven installation on your system with the M2_HOME variable set) Execute the deploy-serverlibs Ant script Highlight all Eclipse projects and choose Maven -> Update Project from the right-click menu; perform the update for all projects Start the Glassfish server and deploy sormas-ear , sormas-rest and sormas-ui by dragging the respective projects onto it, or use the Add and Remove... function by right-clicking on the server Open your browser and type in http://localhost:6080/sormas-ui to test whether the server and IDE have been set up correctly Android Studio Please note: You only need to install Android Studio if you're developing code for the Android app. This is likely the case when you're adding new fields or entities to the system, or if you specifically want to work on the mobile app. Download and install the latest Android Studio version Please make sure to run the installer with admin rights if you're using Windows Ensure that the Android SDK installation path does not contain whitespaces; you can also change this later via Tools -> SDK Manager -> Android SDK Location Open Android Studio and import the sormas-app module from the SORMAS-Project repository Make a copy of keystore.properties.example and rename it to keystore.properties Make sure to use the JDK version 8 ( File -> Project Structure -> SDK Location -> JDK Location ) Build the Android Studio project by executing the Gradle build (this may be done automatically) Add an emulator and set the SDK version to the minSdkVersion or targetSdkVersion from build.gradle ; we suggest to test your code on both, but minSdkVersion should be preferred to ensure compatibility to the minimum supported SDK Click on Run 'app' to install and run the app on your emulator; enter http://10.0.2.2:6080/sormas-rest as the server URL when you start the newly installed app for the first time Important: Whenever you do or pull changes in the sormas-api project that you want to use in the mobile app or that are referenced there already, you need to execute the install Ant script to notify the sormas-app project of the changes. Step 5: Configure Code Formatting and Import Settings In order to ensure a consistent code style and prevent so-called edit wars, we have set up custom configuration files for automatic code formatting and import ordering. Please make sure to adhere to the following steps for your IDE(s) before you start developing. IntelliJ and Android Studio Settings Install the Eclipse Code Formatter for IntelliJ/Android Studio plugin Open the plugin settings via File -> Settings -> Other Settings -> Eclipse Code Formatter and select Use the Eclipse Code Formatter Under Eclipse formatter config , choose Eclipse workspace/project folder or config file and select sormas-base/java-formatter-profile.xml Check Optimize Imports Under Import order , choose From file and select sormas-base/java-importorder-profile.importorder Make sure that Do not format other file types by IntelliJ formatter is selected Go to Editor -> Code Style -> Java -> Imports and set Class count to use import with '*' and Names count to use static import with '*' to 99 Navigate to Editor -> General -> Auto Import and disable Optimize imports on the fly Optional, but strongly recommended: - Install the Save Actions plugin that automatically applies code formatting and import reordering whenever you save a file - otherwise you will manually have to do so (by default with Ctrl+Alt+L) - Open the plugin settings via File -> Settings -> Other Settings -> Save Actions and make sure that the first three checkboxes under General and the first two checkboxes under Formatting Actions are selected Eclipse Settings Open Window -> Preferences Navigate to Java -> Code Style -> Formatter , import sormas-base/java-formatter-profile.xml and apply the changes Navigate to Java -> Code Style -> Organize Imports and import sormas-base/java-importorder-profile.importorder On the same screen, set Number of imports needed for .* and Number of static imports needed for .* to 99 On the same screen, make sure that Do not create import for types starting with a lowercase letter is checked and apply the changes Navigate to Java -> Editor -> Save Actions and make sure that the following options are selected: Perform the selected actions on save , Format source code , Format all lines and Organize imports Issues which can appear during installation process of the project If debug mode does not work: To replace opt\\payara5\\glassfish\\modules\\launcher.jar with sormas-base/setup/launcher.jar For Windows: Please check your java_version. In case if you have the multiple java_versions installed on the system, it will always show to you the first version installed. I had the java 8 instead of 11. In order to fix it, go to environment variables, and move the 11 version up. And rerun the script. Seems that the console is reading those variables at the starting point, and the values of it can be updated only after console/script restart. For Windows: Pay attention to the postgres SQL files rights permissions after unziping the downloaded ZIP archive. Files physically were present but next script error has been generated: psql:setup.sql:7: ERROR: could not open extension control file \"C:/Program Files/PostgreSQL/10/share/extension/temporal_tables.control\": No such file or directory -I checked the file rights, and under windows they has AV attribute, however, all others has only A attribute. When I was trying to open them with Notepad++ it was saying that such file does not exist. Do you want to create it? If yes will be pressed - another message saying that the file exists, appeared. Very strange scenario... All the postgres commands (of added users, etc.) which were added at first startup of the application - will raise errors in case if such entity exists. Just ignore those errors at repeated installation of .\\server-setup.sh Check always the port number 6048 which can be occupied by an old instance of payara. -> For every installation, kill all Java/javaw processes and check the availability of 6048 port number. -> Delete files with generated domain folders and payara. In order to have a clean installation of each next ./server-setup.sh run. M2_HOME need to be set. By default, for newer version, it is set to MAVEN_HOME. But Ant script is looking for M2_HOME For eclipse formatted plugin, there is an issue for Idea: https://plugins.jetbrains.com/plugin/6546-eclipse-code-formatter - cannot save settings Path to custom eclipse folder is not valid - it works only when settings were saved from down to up. And not vice versa.","title":"Development Environment"},{"location":"DEVELOPMENT_ENVIRONMENT/#development-environment-setup","text":"This step-by-step guide explains how to set up your development environment, using either Eclipse or IntelliJ for the backend and web UI and Android Studio for the mobile app. Please follow it strictly to make sure that development will run as smoothly as possible and your code adheres to our guidelines. Please note that these instructions are optimized for Windows and Linux systems. If you're developing on a Mac and, we would be glad to get your feedback about how this guide can be extended with OS-specific instructions in our developer chat on Gitter .","title":"Development Environment Setup"},{"location":"DEVELOPMENT_ENVIRONMENT/#step-1-install-a-local-sormas-server","text":"Please follow the Server Setup Instructions to set up a local SORMAS instance that you will use to test your code. Alternatively, you can also use Maven Cargo , or a Docker installation (not recommended at this time).","title":"Step 1: Install a Local SORMAS Server"},{"location":"DEVELOPMENT_ENVIRONMENT/#step-2-check-out-the-sormas-repository","text":"Download and install the latest Git version for your operating system Optional: Install a Git client such as TortoiseGit or GitHub Desktop if you don't want to handle version control from the command line or within your IDE Optional: Clone the SORMAS-Project repository with git clone https://github.com/hzi-braunschweig/SORMAS-Project.git ; if you want to use Git from within your IDE, you can also clone the repository in Step 4 Open Git Bash and execute the following command to ensure that rebase is used when pulling the development branch rather than merge: git config --global branch.development.rebase true","title":"Step 2: Check Out the SORMAS Repository"},{"location":"DEVELOPMENT_ENVIRONMENT/#step-3-install-java","text":"Download and install the Java 11 JDK (not JRE) for your operating system. We suggest using Zulu OpenJDK . If you're running Linux, please refer to the official documentation on how to install Zulu OpenJDK on your system. If you plan to work on the Android App as well, you will also need the Java 8 JDK to use with Android Studio.","title":"Step 3: Install Java"},{"location":"DEVELOPMENT_ENVIRONMENT/#step-4-install-and-configure-your-ide","text":"","title":"Step 4: Install and Configure Your IDE"},{"location":"DEVELOPMENT_ENVIRONMENT/#intellij","text":"Download and install the latest IntelliJ IDEA Ultimate ; (newer than version of 2020-04-15 to enable debugging, see https://youtrack.jetbrains.com/issue/IDEA-216528 ) Set the project SDK to the installed JDK Optional: Clone the SORMAS-Project repository if you haven't done so already Open the project in IntelliJ. Make sure the project is recognized by IntelliJ as a maven project ; if not, right-click the pom.xml file in sormas-base and select Add as maven project . Make sure that under File -> Project Structure -> Modules all modules EXCEPT sormas-app are recognized; if not, add the missing modules with the + button Navigate to File -> Settings -> Plugins and make sure that Glassfish & Ant integrations are enabled Install the Vaadin 6-8 plugin ; the commercial Vaadin Designer is not needed Make a copy of sormas-base/build.properties.example , rename it to build.properties and set glassfish.domain.root to the location of the SORMAS domain inside your Payara installation Run mvn install on the sormas-base project (e.g. by opening the Maven view and executing sormas-base -> Lifecycle -> install ) Add a Payara server to IntelliJ: Open Run -> Edit Configurations , add a new configuration and choose the Glassfish server template Click on Configure next to Application server and create a new server configuration by selecting your Payara installation directory Check the After launch checkbox and specify the browser that you want SORMAS to open in once the server has been deployed Enter http://localhost:6080/sormas-ui into the URL field Make sure that the correct JRE is specified (your Java 11 JDK) Enter the path to the SORMAS domain and the credentials that you've specified when setting up the server Open the Deployment tab and add the artifacts sormas-ear , sormas-rest and sormas-ui Open the Logs tab and add a new log file pointing to the logs/server.log file in your SORMAS domain Open the Startup/Connection tab and make sure that Pass environment variables is NOT checked; ignore warnings about the debug configuration not being correct Open the config/domain.xml file in your domain directory and make sure that the java-config node contains the following code: <java-config classpath-suffix=\"\" debug-enabled=\"true\" debug-options=\"-agentlib:jdwp=transport=dt_socket,address=6009,server=n,suspend=y\" ... Open the Ant window, click on the + icon and select the sormas-base/build.xml file Execute the install and deploy-serverlibs Ant scripts Set the default working directory for run configurations by navigating to Run -> Edit Configurations -> Templates -> Application and setting Working directory to $MODULE_WORKING_DIR$","title":"IntelliJ"},{"location":"DEVELOPMENT_ENVIRONMENT/#known-issues","text":"The first time you build the project in IntelliJ, you have to switch the java compiler to \"Eclipse\" to workarround a dependency resolution problem in sormas-api.","title":"Known issues"},{"location":"DEVELOPMENT_ENVIRONMENT/#eclipse","text":"Download and install the latest Eclipse IDE for Enterprise Java and Web Developers Set the default JRE of Eclipse to the installed JDK: Assigning the default JRE for the workbench Optional: Clone the SORMAS-Project repository if you haven't done so already via File -> Import -> Git -> Projects from Git and cancel the process when you're asked to create a new project from the cloned repository Import the projects from the SORMAS-Project repository into your workspace via File -> Import -> Maven -> Existing Maven Projects Install the Payara Tools plugin Install the Vaadin Plugin for Eclipse ; the commercial UI designer is not needed Add a Payara server to Eclipse and enter the credentials you specified when setting up the local SORMAS server Make a copy of sormas-base/build.properties.example , rename it to build.properties and set glassfish.domain.root to the location of the SORMAS domain inside your Payara installation Drag the sormas-base/build.xml file into the Ant view in Eclipse Either run mvn install on the sormas-base project or execute the install [default] Ant script (this needs a Maven installation on your system with the M2_HOME variable set) Execute the deploy-serverlibs Ant script Highlight all Eclipse projects and choose Maven -> Update Project from the right-click menu; perform the update for all projects Start the Glassfish server and deploy sormas-ear , sormas-rest and sormas-ui by dragging the respective projects onto it, or use the Add and Remove... function by right-clicking on the server Open your browser and type in http://localhost:6080/sormas-ui to test whether the server and IDE have been set up correctly","title":"Eclipse"},{"location":"DEVELOPMENT_ENVIRONMENT/#android-studio","text":"Please note: You only need to install Android Studio if you're developing code for the Android app. This is likely the case when you're adding new fields or entities to the system, or if you specifically want to work on the mobile app. Download and install the latest Android Studio version Please make sure to run the installer with admin rights if you're using Windows Ensure that the Android SDK installation path does not contain whitespaces; you can also change this later via Tools -> SDK Manager -> Android SDK Location Open Android Studio and import the sormas-app module from the SORMAS-Project repository Make a copy of keystore.properties.example and rename it to keystore.properties Make sure to use the JDK version 8 ( File -> Project Structure -> SDK Location -> JDK Location ) Build the Android Studio project by executing the Gradle build (this may be done automatically) Add an emulator and set the SDK version to the minSdkVersion or targetSdkVersion from build.gradle ; we suggest to test your code on both, but minSdkVersion should be preferred to ensure compatibility to the minimum supported SDK Click on Run 'app' to install and run the app on your emulator; enter http://10.0.2.2:6080/sormas-rest as the server URL when you start the newly installed app for the first time Important: Whenever you do or pull changes in the sormas-api project that you want to use in the mobile app or that are referenced there already, you need to execute the install Ant script to notify the sormas-app project of the changes.","title":"Android Studio"},{"location":"DEVELOPMENT_ENVIRONMENT/#step-5-configure-code-formatting-and-import-settings","text":"In order to ensure a consistent code style and prevent so-called edit wars, we have set up custom configuration files for automatic code formatting and import ordering. Please make sure to adhere to the following steps for your IDE(s) before you start developing.","title":"Step 5: Configure Code Formatting and Import Settings"},{"location":"DEVELOPMENT_ENVIRONMENT/#intellij-and-android-studio-settings","text":"Install the Eclipse Code Formatter for IntelliJ/Android Studio plugin Open the plugin settings via File -> Settings -> Other Settings -> Eclipse Code Formatter and select Use the Eclipse Code Formatter Under Eclipse formatter config , choose Eclipse workspace/project folder or config file and select sormas-base/java-formatter-profile.xml Check Optimize Imports Under Import order , choose From file and select sormas-base/java-importorder-profile.importorder Make sure that Do not format other file types by IntelliJ formatter is selected Go to Editor -> Code Style -> Java -> Imports and set Class count to use import with '*' and Names count to use static import with '*' to 99 Navigate to Editor -> General -> Auto Import and disable Optimize imports on the fly Optional, but strongly recommended: - Install the Save Actions plugin that automatically applies code formatting and import reordering whenever you save a file - otherwise you will manually have to do so (by default with Ctrl+Alt+L) - Open the plugin settings via File -> Settings -> Other Settings -> Save Actions and make sure that the first three checkboxes under General and the first two checkboxes under Formatting Actions are selected","title":"IntelliJ and Android Studio Settings"},{"location":"DEVELOPMENT_ENVIRONMENT/#eclipse-settings","text":"Open Window -> Preferences Navigate to Java -> Code Style -> Formatter , import sormas-base/java-formatter-profile.xml and apply the changes Navigate to Java -> Code Style -> Organize Imports and import sormas-base/java-importorder-profile.importorder On the same screen, set Number of imports needed for .* and Number of static imports needed for .* to 99 On the same screen, make sure that Do not create import for types starting with a lowercase letter is checked and apply the changes Navigate to Java -> Editor -> Save Actions and make sure that the following options are selected: Perform the selected actions on save , Format source code , Format all lines and Organize imports","title":"Eclipse Settings"},{"location":"DEVELOPMENT_ENVIRONMENT/#issues-which-can-appear-during-installation-process-of-the-project","text":"If debug mode does not work: To replace opt\\payara5\\glassfish\\modules\\launcher.jar with sormas-base/setup/launcher.jar For Windows: Please check your java_version. In case if you have the multiple java_versions installed on the system, it will always show to you the first version installed. I had the java 8 instead of 11. In order to fix it, go to environment variables, and move the 11 version up. And rerun the script. Seems that the console is reading those variables at the starting point, and the values of it can be updated only after console/script restart. For Windows: Pay attention to the postgres SQL files rights permissions after unziping the downloaded ZIP archive. Files physically were present but next script error has been generated: psql:setup.sql:7: ERROR: could not open extension control file \"C:/Program Files/PostgreSQL/10/share/extension/temporal_tables.control\": No such file or directory -I checked the file rights, and under windows they has AV attribute, however, all others has only A attribute. When I was trying to open them with Notepad++ it was saying that such file does not exist. Do you want to create it? If yes will be pressed - another message saying that the file exists, appeared. Very strange scenario... All the postgres commands (of added users, etc.) which were added at first startup of the application - will raise errors in case if such entity exists. Just ignore those errors at repeated installation of .\\server-setup.sh Check always the port number 6048 which can be occupied by an old instance of payara. -> For every installation, kill all Java/javaw processes and check the availability of 6048 port number. -> Delete files with generated domain folders and payara. In order to have a clean installation of each next ./server-setup.sh run. M2_HOME need to be set. By default, for newer version, it is set to MAVEN_HOME. But Ant script is looking for M2_HOME For eclipse formatted plugin, there is an issue for Idea: https://plugins.jetbrains.com/plugin/6546-eclipse-code-formatter - cannot save settings Path to custom eclipse folder is not valid - it works only when settings were saved from down to up. And not vice versa.","title":"Issues which can appear during installation process of the project"},{"location":"I18N/","text":"SORMAS Translation FAQ Who is translating SORMAS? The translation of SORMAS relies on people from the community. If you would like to see SORMAS translated to your language, please read the points below and take part in the process. How is SORMAS translated? The official SORMAS translation is done using the Crowdin platform: https://crowdin.com/project/sormas All translations done on the platform are automatically fed into SORMAS and are part of the bi-weekly release schedule. This means that any text you translate will likely be part of the next SORMAS release. Once your server (or the server of your country) is updated you will be able to see the translations in the web app and mobile app. How to participate in translating SORMAS You can join the translation project by creating a free account on Crowdin. You can also use your existing GitHub account. Before starting to translate, you need to request write access to the project. A member of the project will either accept your request or get in touch with you as soon as possible. Afterwards open the SORMAS project https://crowdin.com/project/sormas and select the language you would like to translate. You will see all files that contain translatable texts: The most important one is captions.properties. It contains the captions for all the data entry fields of SORMAS. The captions are shared by the web app and mobile app. Click on the file to open the Crowdin editor that allows you to go through all translation entries one by one as shown in the picture below: How to add a new language to SORMAS If the language you would like to translate is not available yet, please get in contact with us: https://github.com/hzi-braunschweig/SORMAS-Project","title":"I18n"},{"location":"I18N/#sormas-translation-faq","text":"","title":"SORMAS Translation FAQ"},{"location":"I18N/#who-is-translating-sormas","text":"The translation of SORMAS relies on people from the community. If you would like to see SORMAS translated to your language, please read the points below and take part in the process.","title":"Who is translating SORMAS?"},{"location":"I18N/#how-is-sormas-translated","text":"The official SORMAS translation is done using the Crowdin platform: https://crowdin.com/project/sormas All translations done on the platform are automatically fed into SORMAS and are part of the bi-weekly release schedule. This means that any text you translate will likely be part of the next SORMAS release. Once your server (or the server of your country) is updated you will be able to see the translations in the web app and mobile app.","title":"How is SORMAS translated?"},{"location":"I18N/#how-to-participate-in-translating-sormas","text":"You can join the translation project by creating a free account on Crowdin. You can also use your existing GitHub account. Before starting to translate, you need to request write access to the project. A member of the project will either accept your request or get in touch with you as soon as possible. Afterwards open the SORMAS project https://crowdin.com/project/sormas and select the language you would like to translate. You will see all files that contain translatable texts: The most important one is captions.properties. It contains the captions for all the data entry fields of SORMAS. The captions are shared by the web app and mobile app. Click on the file to open the Crowdin editor that allows you to go through all translation entries one by one as shown in the picture below:","title":"How to participate in translating SORMAS"},{"location":"I18N/#how-to-add-a-new-language-to-sormas","text":"If the language you would like to translate is not available yet, please get in contact with us: https://github.com/hzi-braunschweig/SORMAS-Project","title":"How to add a new language to SORMAS"},{"location":"SECURITY/","text":"Security Policies and Procedures This document outlines security procedures and general policies for the SORMAS project. Security Policies and Procedures Reporting a Security Bug Disclosure Policy Comments on this Policy If you want to report a bug which is not security sensible, please submit an issue . Reporting a Security Bug Our team and community take all security bugs in SORMAS seriously. Thank you for improving the security of SORMAS. We appreciate your efforts and responsible disclosure and will make every effort to acknowledge your contributions. Unfortunately, SORMAS does not offer a paid bug bounty programme or other forms of compensation. Report security bugs by emailing at security@sormas.org . We will acknowledge your email and follow up with a response within 10 business days, or explain why a reply may take longer. The response will indicate the next steps in handling your report. After the initial reply to your report, the security team will endeavor to keep you informed of the progress towards a fix and full announcement, and may ask for additional information or guidance. Report security bugs in third-party modules to the person or team maintaining the module. Disclosure Policy When the security team receives a security bug report, they will assign it to a primary handler. This person will coordinate the fix and release process, involving the following steps: Confirm the problem and determine the affected versions. Audit code to find any potential similar problems. Prepare fixes for all releases still under maintenance. These fixes will be released as fast as possible. Comments on this Policy If you have suggestions on how this process could be improved please submit a pull request.","title":"Security"},{"location":"SECURITY/#security-policies-and-procedures","text":"This document outlines security procedures and general policies for the SORMAS project. Security Policies and Procedures Reporting a Security Bug Disclosure Policy Comments on this Policy If you want to report a bug which is not security sensible, please submit an issue .","title":"Security Policies and Procedures"},{"location":"SECURITY/#reporting-a-security-bug","text":"Our team and community take all security bugs in SORMAS seriously. Thank you for improving the security of SORMAS. We appreciate your efforts and responsible disclosure and will make every effort to acknowledge your contributions. Unfortunately, SORMAS does not offer a paid bug bounty programme or other forms of compensation. Report security bugs by emailing at security@sormas.org . We will acknowledge your email and follow up with a response within 10 business days, or explain why a reply may take longer. The response will indicate the next steps in handling your report. After the initial reply to your report, the security team will endeavor to keep you informed of the progress towards a fix and full announcement, and may ask for additional information or guidance. Report security bugs in third-party modules to the person or team maintaining the module.","title":"Reporting a Security Bug"},{"location":"SECURITY/#disclosure-policy","text":"When the security team receives a security bug report, they will assign it to a primary handler. This person will coordinate the fix and release process, involving the following steps: Confirm the problem and determine the affected versions. Audit code to find any potential similar problems. Prepare fixes for all releases still under maintenance. These fixes will be released as fast as possible.","title":"Disclosure Policy"},{"location":"SECURITY/#comments-on-this-policy","text":"If you have suggestions on how this process could be improved please submit a pull request.","title":"Comments on this Policy"},{"location":"SERVER_CUSTOMIZATION/","text":"Configuring and Customizing a SORMAS Server SORMAS has been created and is developed as an international system that can potentially be used everywhere in the world. However, every country naturally has its own requirements and processes, and in addition, there is a set of information that needs to be specified before a SORMAS instance can function properly. For this reason, there are a number of ways in which such a SORMAS instance can be configured and customized: Server Configuration : The basic server configuration is available as a .properties file, needs to be adjusted for every SORMAS instance, and is relevant for both production and development. This should be edited directly after installing the server. Feature Configuration : Most SORMAS features are optional and can be turned on or off directly in the database. Disease Configuration : SORMAS supports a large number of infectious diseases which can be enabled or disabled and further customized directly in the database. Infrastructure Data : Most infrastructure data (except countries and continents) are not shipped with SORMAS because they are country-specific. Importing the infrastructure data of your country (or creating some dummy data) is one of the first things you should do after setting up a SORMAS server. Beyond that, the Wiki contains even more customization options: Adding Disease Variants to a SORMAS Server Customizing the Login and About Pages Customizing the Name and Icon of the Android App Creating a SORMAS2SORMAS Certificate Server Configuration The general SORMAS configuration is stored in the sormas.properties file that you can find in your payara domain folder. When you set up a new SORMAS server, please make sure to go over all entries in that file and adjust their values if necessary. Each property has an explanation telling you its purpose, and some of them also have a default value that you can use to revert the changes you've made. Most of these properties are commented (indicated by a # in front of their name and value), which means that the default value will automatically be used (e.g. the path to temporary files on the server) or the associated feature will not be used at all (e.g. the custom branding properties or the configuration of an external symptom journal). Some properties however are not commented, but also don't have a default value. It is strongly recommended to enter values for these properties because they are required for some parts of SORMAS to work correctly, or because they are very specific to your individual SORMAS instance. This especially applies to the country.locale and country.name properties, which will cause serious problems while using the application if left empty. Important: The sormas.properties file contains all properties that existed in the SORMAS version that you initially installed on your server. New properties added in more recent SORMAS versions are not automatically added! If you're operating a SORMAS server, we strongly suggest to read the release notes of new versions. If properties have been added to this file, they will be communicated in these notes so that you can add them to your properties file. This Wiki page contains a list and explanation of all currently configurable properties. Feature Configuration Some of the features of SORMAS can be enabled or disabled to further customize the system. Right now, this is only possible directly in the featureconfiguration table in the database. This table contains one entry for every configurable feature and is automatically populated during server startup. Setting the enabled to true or false will enable or disable the feature, respectively. Changes are immediately applied to the running system and don't require a server restart. The columns region , district , disease and enddate are currently only applicable for the line listing feature and define the scope in which the line listing is used. Line listing is configurable from the user interface and does not need to be manually edited in the database. Important: If you're using the mobile app, you also need to update the changedate to the current date and time whenever you enable or disable a feature! Otherwise the mobile applications will not be notified about the change. This Wiki page contains a list and explanation of all currently configurable features. Disease Configuration SORMAS supports a wide range of diseases, and not all of those might be relevant to every SORMAS instance or might be used in a different context. As with features, configuring diseases is currently only possible directly in the database via the diseaseconfiguration table. All diseases have a default value for each of their properties that is applied when the respective database entry is empty. Changing these entries overrides that default value. Unlike with features, disease configurations are cached and therefore require you to restart the server before they are applied. Important: If you're using the mobile app, you also need to update the changedate to the current date and time whenever you change a disease configuration! Otherwise the mobile applications will not be notified about the change. It is possible to adjust the following properties that define how the diseases are handled: active : Whether this disease is used in this SORMAS instance. The concrete type of usage is specified by the other properties. primaryDisease : Primary diseases are enabled for case surveillance while non-primary diseases can only be used for pathogen testing. caseBased : Case-based diseases can be used to create cases while non-case-based diseases can be used for aggregate reporting. followUpEnabled : Whether follow-up is enabled for this disease, i.e. the follow-up status can be managed and visits can be created. followUpDuration : The minimum duration of follow-up for contacts of this disease. caseFollowUpDuration : The minimum duration of follow-up for cases of this disease. eventParticipantFollowUpDuration : The minimum duration of follow-up for event participants of this disease. Please note that event participant follow-up is not yet implemented. extendedClassification : Whether this disease uses an extended case classification system that allows users to specify whether a case has been clinically, epidemiologically or laboratory-diagnostically confirmed. extendedClassificationMulti : Whether the three confirmation properties used for extended classification can be specified individually, i.e. users can enter multiple sources of confirmation. Infrastructure Data When you start a SORMAS server for the first time and the createDefaultEntities property is enabled, some default infrastructure data is generated to ensure that the server is usable and the default users can be created. It is recommended (and, unless you're working on a demo server, necessary) to archive this default data and import the official infrastructure data of the country or part of the country that you intend to use SORMAS in instead. SORMAS by default splits infrastructure data into four mandatory categories. Starting from the highest administrative division, these are Regions , Districts , Communities , and Health Facilities . In addition, Points of Entry represent places like harbors and airports where people are frequently entering the country, while Laboratories are technically health facilities that are specifically used for sample testing purposes. The Area infrastructure type can be enabled in the feature configuration and adds another optional layer of infrastructure above Regions. Finally, it is possible to add Countries , Subcontinents and Continents to your system if you also want to collect data from outside the country SORMAS is used in (e.g. because you want to record travels or events). Importing Infrastructure To import your data for one of the administrative divisions, log in as the default admin user (which is created even when createDefaultEntities is disabled) and open the Configuration menu. Open any of the tabs for the infrastructure data you want to import and click on the Import button on the top right. You can download an import guide from within the popup window that will be opened, containing detailed instructions about the import process and the steps you need to go through in order to successfully import your data. Make sure that you always start with the highest administrative division when importing (i.e. at least Countries if you want to collect data from other countries as well, Areas if enabled, or Regions otherwise) and work your way down to the lowest, because lower divisions typically contain mandatory references to higher divisions. For Countries , Subcontinents and Continents , SORMAS provides a default import that allows you to automatically add a complete set of data to your system. For Countries , this default data equals to the official list of countries provided by the WHO . For Subcontinents and Continents , the list is based on the data used by the Robert Koch Institut .","title":"Customization"},{"location":"SERVER_CUSTOMIZATION/#configuring-and-customizing-a-sormas-server","text":"SORMAS has been created and is developed as an international system that can potentially be used everywhere in the world. However, every country naturally has its own requirements and processes, and in addition, there is a set of information that needs to be specified before a SORMAS instance can function properly. For this reason, there are a number of ways in which such a SORMAS instance can be configured and customized: Server Configuration : The basic server configuration is available as a .properties file, needs to be adjusted for every SORMAS instance, and is relevant for both production and development. This should be edited directly after installing the server. Feature Configuration : Most SORMAS features are optional and can be turned on or off directly in the database. Disease Configuration : SORMAS supports a large number of infectious diseases which can be enabled or disabled and further customized directly in the database. Infrastructure Data : Most infrastructure data (except countries and continents) are not shipped with SORMAS because they are country-specific. Importing the infrastructure data of your country (or creating some dummy data) is one of the first things you should do after setting up a SORMAS server. Beyond that, the Wiki contains even more customization options: Adding Disease Variants to a SORMAS Server Customizing the Login and About Pages Customizing the Name and Icon of the Android App Creating a SORMAS2SORMAS Certificate","title":"Configuring and Customizing a SORMAS Server"},{"location":"SERVER_CUSTOMIZATION/#server-configuration","text":"The general SORMAS configuration is stored in the sormas.properties file that you can find in your payara domain folder. When you set up a new SORMAS server, please make sure to go over all entries in that file and adjust their values if necessary. Each property has an explanation telling you its purpose, and some of them also have a default value that you can use to revert the changes you've made. Most of these properties are commented (indicated by a # in front of their name and value), which means that the default value will automatically be used (e.g. the path to temporary files on the server) or the associated feature will not be used at all (e.g. the custom branding properties or the configuration of an external symptom journal). Some properties however are not commented, but also don't have a default value. It is strongly recommended to enter values for these properties because they are required for some parts of SORMAS to work correctly, or because they are very specific to your individual SORMAS instance. This especially applies to the country.locale and country.name properties, which will cause serious problems while using the application if left empty. Important: The sormas.properties file contains all properties that existed in the SORMAS version that you initially installed on your server. New properties added in more recent SORMAS versions are not automatically added! If you're operating a SORMAS server, we strongly suggest to read the release notes of new versions. If properties have been added to this file, they will be communicated in these notes so that you can add them to your properties file. This Wiki page contains a list and explanation of all currently configurable properties.","title":"Server Configuration"},{"location":"SERVER_CUSTOMIZATION/#feature-configuration","text":"Some of the features of SORMAS can be enabled or disabled to further customize the system. Right now, this is only possible directly in the featureconfiguration table in the database. This table contains one entry for every configurable feature and is automatically populated during server startup. Setting the enabled to true or false will enable or disable the feature, respectively. Changes are immediately applied to the running system and don't require a server restart. The columns region , district , disease and enddate are currently only applicable for the line listing feature and define the scope in which the line listing is used. Line listing is configurable from the user interface and does not need to be manually edited in the database. Important: If you're using the mobile app, you also need to update the changedate to the current date and time whenever you enable or disable a feature! Otherwise the mobile applications will not be notified about the change. This Wiki page contains a list and explanation of all currently configurable features.","title":"Feature Configuration"},{"location":"SERVER_CUSTOMIZATION/#disease-configuration","text":"SORMAS supports a wide range of diseases, and not all of those might be relevant to every SORMAS instance or might be used in a different context. As with features, configuring diseases is currently only possible directly in the database via the diseaseconfiguration table. All diseases have a default value for each of their properties that is applied when the respective database entry is empty. Changing these entries overrides that default value. Unlike with features, disease configurations are cached and therefore require you to restart the server before they are applied. Important: If you're using the mobile app, you also need to update the changedate to the current date and time whenever you change a disease configuration! Otherwise the mobile applications will not be notified about the change. It is possible to adjust the following properties that define how the diseases are handled: active : Whether this disease is used in this SORMAS instance. The concrete type of usage is specified by the other properties. primaryDisease : Primary diseases are enabled for case surveillance while non-primary diseases can only be used for pathogen testing. caseBased : Case-based diseases can be used to create cases while non-case-based diseases can be used for aggregate reporting. followUpEnabled : Whether follow-up is enabled for this disease, i.e. the follow-up status can be managed and visits can be created. followUpDuration : The minimum duration of follow-up for contacts of this disease. caseFollowUpDuration : The minimum duration of follow-up for cases of this disease. eventParticipantFollowUpDuration : The minimum duration of follow-up for event participants of this disease. Please note that event participant follow-up is not yet implemented. extendedClassification : Whether this disease uses an extended case classification system that allows users to specify whether a case has been clinically, epidemiologically or laboratory-diagnostically confirmed. extendedClassificationMulti : Whether the three confirmation properties used for extended classification can be specified individually, i.e. users can enter multiple sources of confirmation.","title":"Disease Configuration"},{"location":"SERVER_CUSTOMIZATION/#infrastructure-data","text":"When you start a SORMAS server for the first time and the createDefaultEntities property is enabled, some default infrastructure data is generated to ensure that the server is usable and the default users can be created. It is recommended (and, unless you're working on a demo server, necessary) to archive this default data and import the official infrastructure data of the country or part of the country that you intend to use SORMAS in instead. SORMAS by default splits infrastructure data into four mandatory categories. Starting from the highest administrative division, these are Regions , Districts , Communities , and Health Facilities . In addition, Points of Entry represent places like harbors and airports where people are frequently entering the country, while Laboratories are technically health facilities that are specifically used for sample testing purposes. The Area infrastructure type can be enabled in the feature configuration and adds another optional layer of infrastructure above Regions. Finally, it is possible to add Countries , Subcontinents and Continents to your system if you also want to collect data from outside the country SORMAS is used in (e.g. because you want to record travels or events).","title":"Infrastructure Data"},{"location":"SERVER_CUSTOMIZATION/#importing-infrastructure","text":"To import your data for one of the administrative divisions, log in as the default admin user (which is created even when createDefaultEntities is disabled) and open the Configuration menu. Open any of the tabs for the infrastructure data you want to import and click on the Import button on the top right. You can download an import guide from within the popup window that will be opened, containing detailed instructions about the import process and the steps you need to go through in order to successfully import your data. Make sure that you always start with the highest administrative division when importing (i.e. at least Countries if you want to collect data from other countries as well, Areas if enabled, or Regions otherwise) and work your way down to the lowest, because lower divisions typically contain mandatory references to higher divisions. For Countries , Subcontinents and Continents , SORMAS provides a default import that allows you to automatically add a complete set of data to your system. For Countries , this default data equals to the official list of countries provided by the WHO . For Subcontinents and Continents , the list is based on the data used by the Robert Koch Institut .","title":"Importing Infrastructure"},{"location":"SERVER_DEV_SETUP/","text":"Installing a SORMAS Server for development Note: This guide explains how to configure a SORMAS server on Linux and Windows systems for development. Please note that there is no database setup because the script supposes the use of the Docker Postgresql image (see SORMAS-Docker ). Content Prerequisites Java 11 ant Postgres Database SORMAS Server Related Installing a SORMAS Server Prerequisites Java 11 See Installing Java SORMAS just recently moved to Java 11. We still need to support Java 8 for a transition period. Therefore, please just use Java 8 language features for now. Ant Download and install Ant, it can be done from Ant site or with packages from your Linux distribution. Postgres Database See Installing Postgresql Alternatively you can use the Docker image available in SORMAS-Docker repository. SORMAS Server Install you own Payara server (see installing SORMAS Server ) or run bash ./server-setup-dev-docker.sh This script will download Payara (if needed) and install SORMAS in the Payara server. You can edit this script to change paths and ports. Other steps : * IMPORTANT : Adjust the SORMAS configuration for your country in /opt/domains/sormas/sormas.properties * Adjust the logging configuration in ${HOME}/opt/domains/sormas/config/logback.xml based on your needs (e.g. configure and activate email appender) * Build and deploy applications (ear and war) with you IDE. Keycloak See Keycloak for how to install Docker locally. If you are doing active development on Keycloak (themes, authentication mechanisms, translations, etc.) it's recommended to install the standalone variant. VAADIN Debug Mode To enable VAADIN Debug Mode , go to sormas-ui/src/main/webapp/WEB-INF/web.xml and set productionMode to false . Make sure not to commit your changes to these files, for example by using .gitignore. To access the debug Window, got to /sormas-ui/?debug. You may need to log in as admin once first. Other components See Installing a SORMAS Server","title":"Development Setup"},{"location":"SERVER_DEV_SETUP/#installing-a-sormas-server-for-development","text":"Note: This guide explains how to configure a SORMAS server on Linux and Windows systems for development. Please note that there is no database setup because the script supposes the use of the Docker Postgresql image (see SORMAS-Docker ).","title":"Installing a SORMAS Server for development"},{"location":"SERVER_DEV_SETUP/#content","text":"Prerequisites Java 11 ant Postgres Database SORMAS Server","title":"Content"},{"location":"SERVER_DEV_SETUP/#related","text":"Installing a SORMAS Server","title":"Related"},{"location":"SERVER_DEV_SETUP/#prerequisites","text":"","title":"Prerequisites"},{"location":"SERVER_DEV_SETUP/#java-11","text":"See Installing Java SORMAS just recently moved to Java 11. We still need to support Java 8 for a transition period. Therefore, please just use Java 8 language features for now.","title":"Java 11"},{"location":"SERVER_DEV_SETUP/#ant","text":"Download and install Ant, it can be done from Ant site or with packages from your Linux distribution.","title":"Ant"},{"location":"SERVER_DEV_SETUP/#postgres-database","text":"See Installing Postgresql Alternatively you can use the Docker image available in SORMAS-Docker repository.","title":"Postgres Database"},{"location":"SERVER_DEV_SETUP/#sormas-server","text":"Install you own Payara server (see installing SORMAS Server ) or run bash ./server-setup-dev-docker.sh This script will download Payara (if needed) and install SORMAS in the Payara server. You can edit this script to change paths and ports. Other steps : * IMPORTANT : Adjust the SORMAS configuration for your country in /opt/domains/sormas/sormas.properties * Adjust the logging configuration in ${HOME}/opt/domains/sormas/config/logback.xml based on your needs (e.g. configure and activate email appender) * Build and deploy applications (ear and war) with you IDE.","title":"SORMAS Server"},{"location":"SERVER_DEV_SETUP/#keycloak","text":"See Keycloak for how to install Docker locally. If you are doing active development on Keycloak (themes, authentication mechanisms, translations, etc.) it's recommended to install the standalone variant.","title":"Keycloak"},{"location":"SERVER_DEV_SETUP/#vaadin-debug-mode","text":"To enable VAADIN Debug Mode , go to sormas-ui/src/main/webapp/WEB-INF/web.xml and set productionMode to false . Make sure not to commit your changes to these files, for example by using .gitignore. To access the debug Window, got to /sormas-ui/?debug. You may need to log in as admin once first.","title":"VAADIN Debug Mode"},{"location":"SERVER_DEV_SETUP/#other-components","text":"See Installing a SORMAS Server","title":"Other components"},{"location":"SERVER_SETUP/","text":"Installing a SORMAS Server Note: This guide explains how to set up a SORMAS server on Linux and Windows systems, the latter only being intended for usage on development systems. Please also note that certain parts of the setup script will not be executed on Windows. Content Installing a SORMAS Server Content Related Prerequisites Java 11 Linux Windows Postgres Database SORMAS Server Install on Linux Install on Windows Post-Installation Configuration Keycloak Server Keycloak as a Docker container Keycloak as a standalone installation Connect Keycloak to an already running instance of SORMAS Keycloak configuration Web Server Setup Apache Web Server Firewall Postfix Mail Server Install postfix and mailutils Configure your system Testing the Server Setup R Software Environment SORMAS to SORMAS Certificate Setup Troubleshooting Problem: Login fails Problem: Server is out of memory Related Creating an App for a Demo Server SORMAS Docker Repository Prerequisites Java 11 Download and install the Java 11 JDK (not JRE) for your operating system. We suggest using the Zulu OpenJDK . Linux sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 0xB1998361219BD9C9 sudo apt-add-repository 'deb https://repos.azul.com/zulu/deb/ stable main' sudo apt-get update sudo apt-get install zulu11 Windows For testing and development environments we suggest to download and run the installer of the Java 11 JDK for 32 or 64 bit client systems (depending on your system). You can check your Java version from the shell/command line using: java -version . Postgres Database Install PostgreSQL (currently 9.5, 9.6 or 10) on your system (manuals for all OS can be found here: https://www.postgresql.org/download ) Set max_connections = 288 and max_prepared_transactions = 256 (at least, sum of all connection pools) in postgresql.conf (e.g. /etc/postgresql/10.0/main/postgresql.conf ; C:/Program Files/PostgreSQL/10.0/data ) - make sure the property is uncommented and restart the service to apply the changes. Install the \"temporal tables\" extension for Postgres ( https://github.com/arkhipov/temporal_tables ) Windows : Download the latest version for your Postgres version: https://github.com/arkhipov/temporal_tables/releases/latest , then copy the DLL from the project into the PostgreSQL's lib directory and the .sql and .control files into the directory share\\extension. Linux (see https://github.com/arkhipov/temporal_tables#installation) sudo apt-get install libpq-dev sudo apt-get install postgresql-server-dev-all sudo apt install pgxnclient #Check for GCC: gcc --version # and install if missing sudo pgxn install temporal_tables # The packages can be removed afterward SORMAS Server Get the latest SORMAS build by downloading the ZIP archive from the latest release on GitHub: https://github.com/hzi-braunschweig/SORMAS-Project/releases/latest Install on Linux Unzip the archive, copy/upload its contents to /root/deploy/sormas/$(date +%F) and make the setup script executable (as root user). sudo su mkdir /root/deploy/sormas cd /root/deploy/sormas SORMAS_VERSION=1.y.z wget https://github.com/hzi-braunschweig/SORMAS-Project/releases/download/v${SORMAS_VERSION}/sormas_${SORMAS_VERSION}.zip unzip sormas_${SORMAS_VERSION}.zip mv deploy/ $(date +%F) rm sormas_${SORMAS_VERSION}.zip chmod +x $(date +%F)/server-setup.sh Install on Windows Download & install Git for Windows. This will provide a bash emulation that you can use to run the setup script: https://gitforwindows.org/ Unzip the ZIP archive (e.g. into you download directory) Open Git Bash and navigate to the setup sub-directory Post-Installation Configuration Optional: Open server-setup.sh in a text editor to customize the install paths, database access and ports for the server. The default ports are 6080 (HTTP), 6081 (HTTPS) and 6048 (admin). Important: Do not change the name of the database user. The pre-defined name is used in the statements executed in the database. Set up the database and a Payara domain for SORMAS by executing the setup script: sudo -s ./server-setup.sh Press enter whenever asked for it IMPORTANT : Make sure the script executed successfully. If anything goes wrong you need to fix the problem (or ask for help), then delete the created domain directory and re-execute the script. IMPORTANT : Adjust the SORMAS configuration for your country in /opt/domains/sormas/sormas.properties Adjust the logging configuration in /opt/domains/sormas/config/logback.xml based on your needs (e.g. configure and activate email appender) Linux: Update the SORMAS domain Keycloak Server Keycloak can be set up in two ways: * as a Docker container (for just using Keycloak approach) * as a Standalone installation (for doing development in Keycloak like themes, SPIs) Keycloak as a Docker container To be done only in the situation when SORMAS is already installed on the machine as a standalone installation. For complete Docker setup see the SORMAS-Docker repository. Prerequisites * SORMAS Server is installed * PostgreSQL is installed * Docker is installed * Open and edit sormas-base/setup/keycloak/keycloak-setup.sh with your system's actual values (on Windows use Git Bash) . Setup * Run sormas-base/setup/keycloak/keycloak-setup.sh * Update sormas.properties file in the SORMAS domain with the property authentication.provider=KEYCLOAK Keycloak as a standalone installation Prerequisites * SORMAS Server is installed * PostgreSQL is installed Setup Setting Keycloak up as a standalone installation Server Installation and Configuration Guide * Make sure to configure Keycloak with PostgreSQL Database Relational Database Setup * Set up an Admin User * Copy the themes folder content to ${KEYCLOAK_HOME}/themes Deploying Themes * Deploy the sormas-keycloak-service-provider Using Keycloak Deployer * Update the sormas-base/setup/keycloak/SORMAS.json file by replacing the following placeholders: ${SORMAS_SERVER_URL} , ${KEYCLOAK_SORMAS_UI_SECRET} , ${KEYCLOAK_SORMAS_BACKEND_SECRET} , ${KEYCLOAK_SORMAS_REST_SECRET} * Create the SORMAS Realm by importing sormas-base/setup/keycloak/SORMAS.json see Create a New Realm * Update the sormas-* clients by generating new secrets for them * Update the realm's email settings to allow sending emails to users To update the SORMAS Server run the following commands: ${ASADMIN} set-config-property --propertyName=payara.security.openid.clientSecret --propertyValue=${KEYCLOAK_SORMAS_UI_SECRET} --source=domain ${ASADMIN} set-config-property --propertyName=payara.security.openid.clientId --propertyValue=sormas-ui --source=domain ${ASADMIN} set-config-property --propertyName=payara.security.openid.scope --propertyValue=openid --source=domain ${ASADMIN} set-config-property --propertyName=payara.security.openid.providerURI --propertyValue=http://localhost:${KEYCLOAK_PORT}/keycloak/auth/realms/SORMAS --source=domain ${ASADMIN} set-config-property --propertyName=sormas.rest.security.oidc.json \\ --propertyValue=\"{\\\"realm\\\":\\\"SORMAS\\\",\\\"auth-server-url\\\":\\\"http://localhost:${KEYCLOAK_PORT}/auth\\\",\\\"ssl-required\\\":\\\"external\\\",\\\"resource\\\":\\\"sormas-rest\\\",\\\"credentials\\\":{\\\"secret\\\":\\\"${KEYCLOAK_SORMAS_REST_SECRET}\\\"},\\\"confidential-port\\\":0,\\\"principal-attribute\\\":\\\"preferred_username\\\",\\\"enable-basic-auth\\\":true}\" \\ --source=domain ${ASADMIN} set-config-property --propertyName=sormas.backend.security.oidc.json --propertyValue=\"{\\\"realm\\\":\\\"SORMAS\\\",\\\"auth-server-url\\\":\\\"http://localhost:${KEYCLOAK_PORT}/auth/\\\",\\\"ssl-required\\\":\\\"external\\\",\\\"resource\\\":\\\"sormas-backend\\\",\\\"credentials\\\":{\\\"secret\\\":\\\"${KEYCLOAK_SORMAS_BACKEND_SECRET}\\\"},\\\"confidential-port\\\":0}\" --source=domain where: * ${ASADMIN} - represents the location to ${PAYARA_HOME}\\bin\\asadmin * ${KEYCLOAK_PORT} - the port on which keycloak will run * ${KEYCLOAK_SORMAS_UI_SECRET} - is the secret generated in Keycloak for the sormas-ui client * ${KEYCLOAK_SORMAS_REST_SECRET} - is the secret generated in Keycloak for the sormas-rest client * ${KEYCLOAK_SORMAS_BACKEND_SECRET} - is the secret generated in Keycloak for the sormas-backend client Then update sormas.properties file in the SORMAS domain with the property authentication.provider=KEYCLOAK Connect Keycloak to an already running instance of SORMAS after setting up Keycloak as one of the described options above In case Keycloak is set up alongside an already running instance of SORMAS, these are the steps to follow to make sure already existing users can access the system: 1. Manually create an admin user in Keycloak for the SORMAS realm Creating a user (username has to be the same as admin's username in SORMAS) 2. Login to SORMAS and trigger the Sync Users button from the Users page 3. This will sync users to Keycloak keeping their original password - see SORMAS Keycloak Service Provider for more information about this Keycloak configuration More about the default configuration and how to customize can be found here Keycloak Web Server Setup Apache Web Server Note: This is not necessary for development systems. When you are using SORMAS in a production environment you should use a http server like Apache 2 instead of putting the Payara server in the first line. Here are some things that you should do to configure the Apache server as a proxy: Activate all needed modules: a2enmod ssl a2enmod rewrite a2enmod proxy a2enmod proxy_http a2enmod headers Create a new site /etc/apache2/sites-available/your.sormas.server.url.conf (e.g. sormas.org.conf). Force SSL secured connections: redirect from http to https: <VirtualHost *:80> ServerName your.sormas.server.url RewriteEngine On RewriteCond %{HTTPS} !=on RewriteRule ^/(.*) https://your.sormas.server.url/$1 [R,L] </VirtualHost> <IfModule mod_ssl.c> <VirtualHost *:443> ServerName your.sormas.server.url ... </VirtualHost> </IfModule> Configure logging: ErrorLog /var/log/apache2/error.log LogLevel warn LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b _%D_ \\\"%{User}i\\\" \\\"%{Connection}i\\\" \\\"%{Referer}i\\\" \\\"%{User-agent}i\\\"\" combined_ext CustomLog /var/log/apache2/access.log combined_ext SSL key config: SSLEngine on SSLCertificateFile /etc/ssl/certs/your.sormas.server.url.crt SSLCertificateKeyFile /etc/ssl/private/your.sormas.server.url.key SSLCertificateChainFile /etc/ssl/certs/your.sormas.server.url.ca-bundle # disable weak ciphers and old TLS/SSL SSLProtocol all -SSLv3 -TLSv1 -TLSv1.1 SSLCipherSuite ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE$ SSLHonorCipherOrder off Add a proxy pass to the local port: ProxyRequests Off ProxyPass /sormas-ui http://localhost:6080/sormas-ui ProxyPassReverse /sormas-ui http://localhost:6080/sormas-ui ProxyPass /sormas-rest http://localhost:6080/sormas-rest ProxyPassReverse /sormas-rest http://localhost:6080/sormas-rest Configure security settings: Header always set X-Content-Type-Options \"nosniff\" Header always set X-Xss-Protection \"1; mode=block\" # Disable Caching Header always set Cache-Control \"no-cache, no-store, must-revalidate, private\" Header always set Pragma \"no-cache\" Header always set Content-Security-Policy \\ \"default-src 'none'; \\ object-src 'self'; \\ script-src 'self' 'unsafe-inline' 'unsafe-eval'; \\ connect-src https://fonts.googleapis.com https://fonts.gstatic.com 'self'; \\ img-src *; \\ style-src 'self' https://fonts.googleapis.com 'unsafe-inline'; \\ font-src https://fonts.gstatic.com 'self'; \\ frame-src 'self'; \\ worker-src 'self'; \\ manifest-src 'self'; \\ frame-ancestors 'self' # The Content-Type header was either missing or empty. # Ensure each page is setting the specific and appropriate content-type value for the content being delivered. AddType application/vnd.ms-fontobject .eot AddType application/x-font-opentype .otf AddType image/svg+xml .svg AddType application/x-font-ttf .ttf AddType application/font-woff .woff Activate output compression (very important!): <IfModule mod_deflate.c> AddOutputFilterByType DEFLATE text/plain text/html text/xml AddOutputFilterByType DEFLATE text/css text/javascript AddOutputFilterByType DEFLATE application/json AddOutputFilterByType DEFLATE application/xml application/xhtml+xml AddOutputFilterByType DEFLATE application/javascript application/x-javascript DeflateCompressionLevel 1 </IfModule> Provide the android apk: Options -Indexes AliasMatch \"/downloads/sormas-(.*)\" \"/var/www/sormas/downloads/sormas-$1\" For the Apache 2 security configuration we suggest the following settings ( /etc/apache2/conf-available/security.conf ): ServerTokens Prod ServerSignature Off TraceEnable Off Header always set Strict-Transport-Security \"max-age=15768000; includeSubDomains; preload\" Header unset X-Frame-Options Header always set X-Frame-Options SAMEORIGIN Header unset Referrer-Policy Header always set Referrer-Policy \"same-origin\" Header edit Set-Cookie \"(?i)^((?:(?!;\\s?HttpOnly).)+)$\" \"$1;HttpOnly\" Header edit Set-Cookie \"(?i)^((?:(?!;\\s?Secure).)+)$\" \"$1;Secure\" Header unset X-Powered-By Header unset Server In case you need to update the site config while the server is running, use the following command to publish the changes without the need for a reload: apache2ctl graceful Firewall The server should only publish the ports that are needed. For SORMAS this is port 80 (HTTP) and 443 (HTTPS). In addition you will need the SSH port to access the server for admin purposes. We suggest to use UFW (Uncomplicated Firewall) which provides a simple interface to iptables: sudo apt-get install ufw sudo ufw default deny incoming sudo ufw default allow outgoing sudo ufw allow ssh sudo ufw allow http sudo ufw allow https sudo ufw enable Postfix Mail Server Install postfix and mailutils apt install aptitude aptitude install postfix -> choose \"satelite system\" apt install mailutils Configure your system nano /etc/aliases -> add \"root: enter-your@support-email-here.com\" nano /opt/domains/sormas/config/logback.xml -> make sure \"EMAIL_ERROR\" appender is active and sends out to your email address Testing the Server Setup Use SSL Labs to test your server security config: https://www.ssllabs.com/ssltest R Software Environment In order to enable disease network diagrams in the contact dashboard, R and several extension packages are required. Then the Rscript executable has to be configured in the sormas.properties file. This can be conveniently accomplished by executing the R setup script from the SORMAS ZIP archive (see SORMAS Server ): If the SORMAS installation has been customized, r-setup.sh the install paths may have to be adjusted accordingly with a text editor. Execute R setup script and follow its instructions. chmod +x r-setup.sh ./r-setup.sh SORMAS to SORMAS Certificate Setup To be able to communicate with other SORMAS instances, there are some additional steps which need to be taken, in order to set up the certificate and the truststore. Please see the related guide for detailed instructions regarding SORMAS to SORMAS setup. Troubleshooting Problem: Login fails Check that the users table does have a corresponding entry. If not, the database initialization that is done when deploying sormas-ear.ear probably had an error. Problem: Server is out of memory Old servers were set up with a memory size of less than 2048MB. You can change this using the following commands: /opt/payara-172/glassfish/bin/asadmin --port 6048 delete-jvm-options -Xmx512m /opt/payara-172/glassfish/bin/asadmin --port 6048 delete-jvm-options -Xmx1024m /opt/payara-172/glassfish/bin/asadmin --port 6048 create-jvm-options -Xmx2048m Alternative: You can edit the settings directly in the domain.xml in the config directory of the SORMAS domain. Just search for Xmx - there should be two entries that need to be changed.","title":"Setup"},{"location":"SERVER_SETUP/#installing-a-sormas-server","text":"Note: This guide explains how to set up a SORMAS server on Linux and Windows systems, the latter only being intended for usage on development systems. Please also note that certain parts of the setup script will not be executed on Windows.","title":"Installing a SORMAS Server"},{"location":"SERVER_SETUP/#content","text":"Installing a SORMAS Server Content Related Prerequisites Java 11 Linux Windows Postgres Database SORMAS Server Install on Linux Install on Windows Post-Installation Configuration Keycloak Server Keycloak as a Docker container Keycloak as a standalone installation Connect Keycloak to an already running instance of SORMAS Keycloak configuration Web Server Setup Apache Web Server Firewall Postfix Mail Server Install postfix and mailutils Configure your system Testing the Server Setup R Software Environment SORMAS to SORMAS Certificate Setup Troubleshooting Problem: Login fails Problem: Server is out of memory","title":"Content"},{"location":"SERVER_SETUP/#related","text":"Creating an App for a Demo Server SORMAS Docker Repository","title":"Related"},{"location":"SERVER_SETUP/#prerequisites","text":"","title":"Prerequisites"},{"location":"SERVER_SETUP/#java-11","text":"Download and install the Java 11 JDK (not JRE) for your operating system. We suggest using the Zulu OpenJDK .","title":"Java 11"},{"location":"SERVER_SETUP/#linux","text":"sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 0xB1998361219BD9C9 sudo apt-add-repository 'deb https://repos.azul.com/zulu/deb/ stable main' sudo apt-get update sudo apt-get install zulu11","title":"Linux"},{"location":"SERVER_SETUP/#windows","text":"For testing and development environments we suggest to download and run the installer of the Java 11 JDK for 32 or 64 bit client systems (depending on your system). You can check your Java version from the shell/command line using: java -version .","title":"Windows"},{"location":"SERVER_SETUP/#postgres-database","text":"Install PostgreSQL (currently 9.5, 9.6 or 10) on your system (manuals for all OS can be found here: https://www.postgresql.org/download ) Set max_connections = 288 and max_prepared_transactions = 256 (at least, sum of all connection pools) in postgresql.conf (e.g. /etc/postgresql/10.0/main/postgresql.conf ; C:/Program Files/PostgreSQL/10.0/data ) - make sure the property is uncommented and restart the service to apply the changes. Install the \"temporal tables\" extension for Postgres ( https://github.com/arkhipov/temporal_tables ) Windows : Download the latest version for your Postgres version: https://github.com/arkhipov/temporal_tables/releases/latest , then copy the DLL from the project into the PostgreSQL's lib directory and the .sql and .control files into the directory share\\extension. Linux (see https://github.com/arkhipov/temporal_tables#installation) sudo apt-get install libpq-dev sudo apt-get install postgresql-server-dev-all sudo apt install pgxnclient #Check for GCC: gcc --version # and install if missing sudo pgxn install temporal_tables # The packages can be removed afterward","title":"Postgres Database"},{"location":"SERVER_SETUP/#sormas-server","text":"Get the latest SORMAS build by downloading the ZIP archive from the latest release on GitHub: https://github.com/hzi-braunschweig/SORMAS-Project/releases/latest","title":"SORMAS Server"},{"location":"SERVER_SETUP/#install-on-linux","text":"Unzip the archive, copy/upload its contents to /root/deploy/sormas/$(date +%F) and make the setup script executable (as root user). sudo su mkdir /root/deploy/sormas cd /root/deploy/sormas SORMAS_VERSION=1.y.z wget https://github.com/hzi-braunschweig/SORMAS-Project/releases/download/v${SORMAS_VERSION}/sormas_${SORMAS_VERSION}.zip unzip sormas_${SORMAS_VERSION}.zip mv deploy/ $(date +%F) rm sormas_${SORMAS_VERSION}.zip chmod +x $(date +%F)/server-setup.sh","title":"Install on Linux"},{"location":"SERVER_SETUP/#install-on-windows","text":"Download & install Git for Windows. This will provide a bash emulation that you can use to run the setup script: https://gitforwindows.org/ Unzip the ZIP archive (e.g. into you download directory) Open Git Bash and navigate to the setup sub-directory","title":"Install on Windows"},{"location":"SERVER_SETUP/#post-installation-configuration","text":"Optional: Open server-setup.sh in a text editor to customize the install paths, database access and ports for the server. The default ports are 6080 (HTTP), 6081 (HTTPS) and 6048 (admin). Important: Do not change the name of the database user. The pre-defined name is used in the statements executed in the database. Set up the database and a Payara domain for SORMAS by executing the setup script: sudo -s ./server-setup.sh Press enter whenever asked for it IMPORTANT : Make sure the script executed successfully. If anything goes wrong you need to fix the problem (or ask for help), then delete the created domain directory and re-execute the script. IMPORTANT : Adjust the SORMAS configuration for your country in /opt/domains/sormas/sormas.properties Adjust the logging configuration in /opt/domains/sormas/config/logback.xml based on your needs (e.g. configure and activate email appender) Linux: Update the SORMAS domain","title":"Post-Installation Configuration"},{"location":"SERVER_SETUP/#keycloak-server","text":"Keycloak can be set up in two ways: * as a Docker container (for just using Keycloak approach) * as a Standalone installation (for doing development in Keycloak like themes, SPIs)","title":"Keycloak Server"},{"location":"SERVER_SETUP/#keycloak-as-a-docker-container","text":"To be done only in the situation when SORMAS is already installed on the machine as a standalone installation. For complete Docker setup see the SORMAS-Docker repository. Prerequisites * SORMAS Server is installed * PostgreSQL is installed * Docker is installed * Open and edit sormas-base/setup/keycloak/keycloak-setup.sh with your system's actual values (on Windows use Git Bash) . Setup * Run sormas-base/setup/keycloak/keycloak-setup.sh * Update sormas.properties file in the SORMAS domain with the property authentication.provider=KEYCLOAK","title":"Keycloak as a Docker container"},{"location":"SERVER_SETUP/#keycloak-as-a-standalone-installation","text":"Prerequisites * SORMAS Server is installed * PostgreSQL is installed Setup Setting Keycloak up as a standalone installation Server Installation and Configuration Guide * Make sure to configure Keycloak with PostgreSQL Database Relational Database Setup * Set up an Admin User * Copy the themes folder content to ${KEYCLOAK_HOME}/themes Deploying Themes * Deploy the sormas-keycloak-service-provider Using Keycloak Deployer * Update the sormas-base/setup/keycloak/SORMAS.json file by replacing the following placeholders: ${SORMAS_SERVER_URL} , ${KEYCLOAK_SORMAS_UI_SECRET} , ${KEYCLOAK_SORMAS_BACKEND_SECRET} , ${KEYCLOAK_SORMAS_REST_SECRET} * Create the SORMAS Realm by importing sormas-base/setup/keycloak/SORMAS.json see Create a New Realm * Update the sormas-* clients by generating new secrets for them * Update the realm's email settings to allow sending emails to users To update the SORMAS Server run the following commands: ${ASADMIN} set-config-property --propertyName=payara.security.openid.clientSecret --propertyValue=${KEYCLOAK_SORMAS_UI_SECRET} --source=domain ${ASADMIN} set-config-property --propertyName=payara.security.openid.clientId --propertyValue=sormas-ui --source=domain ${ASADMIN} set-config-property --propertyName=payara.security.openid.scope --propertyValue=openid --source=domain ${ASADMIN} set-config-property --propertyName=payara.security.openid.providerURI --propertyValue=http://localhost:${KEYCLOAK_PORT}/keycloak/auth/realms/SORMAS --source=domain ${ASADMIN} set-config-property --propertyName=sormas.rest.security.oidc.json \\ --propertyValue=\"{\\\"realm\\\":\\\"SORMAS\\\",\\\"auth-server-url\\\":\\\"http://localhost:${KEYCLOAK_PORT}/auth\\\",\\\"ssl-required\\\":\\\"external\\\",\\\"resource\\\":\\\"sormas-rest\\\",\\\"credentials\\\":{\\\"secret\\\":\\\"${KEYCLOAK_SORMAS_REST_SECRET}\\\"},\\\"confidential-port\\\":0,\\\"principal-attribute\\\":\\\"preferred_username\\\",\\\"enable-basic-auth\\\":true}\" \\ --source=domain ${ASADMIN} set-config-property --propertyName=sormas.backend.security.oidc.json --propertyValue=\"{\\\"realm\\\":\\\"SORMAS\\\",\\\"auth-server-url\\\":\\\"http://localhost:${KEYCLOAK_PORT}/auth/\\\",\\\"ssl-required\\\":\\\"external\\\",\\\"resource\\\":\\\"sormas-backend\\\",\\\"credentials\\\":{\\\"secret\\\":\\\"${KEYCLOAK_SORMAS_BACKEND_SECRET}\\\"},\\\"confidential-port\\\":0}\" --source=domain where: * ${ASADMIN} - represents the location to ${PAYARA_HOME}\\bin\\asadmin * ${KEYCLOAK_PORT} - the port on which keycloak will run * ${KEYCLOAK_SORMAS_UI_SECRET} - is the secret generated in Keycloak for the sormas-ui client * ${KEYCLOAK_SORMAS_REST_SECRET} - is the secret generated in Keycloak for the sormas-rest client * ${KEYCLOAK_SORMAS_BACKEND_SECRET} - is the secret generated in Keycloak for the sormas-backend client Then update sormas.properties file in the SORMAS domain with the property authentication.provider=KEYCLOAK","title":"Keycloak as a standalone installation"},{"location":"SERVER_SETUP/#connect-keycloak-to-an-already-running-instance-of-sormas","text":"after setting up Keycloak as one of the described options above In case Keycloak is set up alongside an already running instance of SORMAS, these are the steps to follow to make sure already existing users can access the system: 1. Manually create an admin user in Keycloak for the SORMAS realm Creating a user (username has to be the same as admin's username in SORMAS) 2. Login to SORMAS and trigger the Sync Users button from the Users page 3. This will sync users to Keycloak keeping their original password - see SORMAS Keycloak Service Provider for more information about this","title":"Connect Keycloak to an already running instance of SORMAS"},{"location":"SERVER_SETUP/#keycloak-configuration","text":"More about the default configuration and how to customize can be found here Keycloak","title":"Keycloak configuration"},{"location":"SERVER_SETUP/#web-server-setup","text":"","title":"Web Server Setup"},{"location":"SERVER_SETUP/#apache-web-server","text":"Note: This is not necessary for development systems. When you are using SORMAS in a production environment you should use a http server like Apache 2 instead of putting the Payara server in the first line. Here are some things that you should do to configure the Apache server as a proxy: Activate all needed modules: a2enmod ssl a2enmod rewrite a2enmod proxy a2enmod proxy_http a2enmod headers Create a new site /etc/apache2/sites-available/your.sormas.server.url.conf (e.g. sormas.org.conf). Force SSL secured connections: redirect from http to https: <VirtualHost *:80> ServerName your.sormas.server.url RewriteEngine On RewriteCond %{HTTPS} !=on RewriteRule ^/(.*) https://your.sormas.server.url/$1 [R,L] </VirtualHost> <IfModule mod_ssl.c> <VirtualHost *:443> ServerName your.sormas.server.url ... </VirtualHost> </IfModule> Configure logging: ErrorLog /var/log/apache2/error.log LogLevel warn LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b _%D_ \\\"%{User}i\\\" \\\"%{Connection}i\\\" \\\"%{Referer}i\\\" \\\"%{User-agent}i\\\"\" combined_ext CustomLog /var/log/apache2/access.log combined_ext SSL key config: SSLEngine on SSLCertificateFile /etc/ssl/certs/your.sormas.server.url.crt SSLCertificateKeyFile /etc/ssl/private/your.sormas.server.url.key SSLCertificateChainFile /etc/ssl/certs/your.sormas.server.url.ca-bundle # disable weak ciphers and old TLS/SSL SSLProtocol all -SSLv3 -TLSv1 -TLSv1.1 SSLCipherSuite ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE$ SSLHonorCipherOrder off Add a proxy pass to the local port: ProxyRequests Off ProxyPass /sormas-ui http://localhost:6080/sormas-ui ProxyPassReverse /sormas-ui http://localhost:6080/sormas-ui ProxyPass /sormas-rest http://localhost:6080/sormas-rest ProxyPassReverse /sormas-rest http://localhost:6080/sormas-rest Configure security settings: Header always set X-Content-Type-Options \"nosniff\" Header always set X-Xss-Protection \"1; mode=block\" # Disable Caching Header always set Cache-Control \"no-cache, no-store, must-revalidate, private\" Header always set Pragma \"no-cache\" Header always set Content-Security-Policy \\ \"default-src 'none'; \\ object-src 'self'; \\ script-src 'self' 'unsafe-inline' 'unsafe-eval'; \\ connect-src https://fonts.googleapis.com https://fonts.gstatic.com 'self'; \\ img-src *; \\ style-src 'self' https://fonts.googleapis.com 'unsafe-inline'; \\ font-src https://fonts.gstatic.com 'self'; \\ frame-src 'self'; \\ worker-src 'self'; \\ manifest-src 'self'; \\ frame-ancestors 'self' # The Content-Type header was either missing or empty. # Ensure each page is setting the specific and appropriate content-type value for the content being delivered. AddType application/vnd.ms-fontobject .eot AddType application/x-font-opentype .otf AddType image/svg+xml .svg AddType application/x-font-ttf .ttf AddType application/font-woff .woff Activate output compression (very important!): <IfModule mod_deflate.c> AddOutputFilterByType DEFLATE text/plain text/html text/xml AddOutputFilterByType DEFLATE text/css text/javascript AddOutputFilterByType DEFLATE application/json AddOutputFilterByType DEFLATE application/xml application/xhtml+xml AddOutputFilterByType DEFLATE application/javascript application/x-javascript DeflateCompressionLevel 1 </IfModule> Provide the android apk: Options -Indexes AliasMatch \"/downloads/sormas-(.*)\" \"/var/www/sormas/downloads/sormas-$1\" For the Apache 2 security configuration we suggest the following settings ( /etc/apache2/conf-available/security.conf ): ServerTokens Prod ServerSignature Off TraceEnable Off Header always set Strict-Transport-Security \"max-age=15768000; includeSubDomains; preload\" Header unset X-Frame-Options Header always set X-Frame-Options SAMEORIGIN Header unset Referrer-Policy Header always set Referrer-Policy \"same-origin\" Header edit Set-Cookie \"(?i)^((?:(?!;\\s?HttpOnly).)+)$\" \"$1;HttpOnly\" Header edit Set-Cookie \"(?i)^((?:(?!;\\s?Secure).)+)$\" \"$1;Secure\" Header unset X-Powered-By Header unset Server In case you need to update the site config while the server is running, use the following command to publish the changes without the need for a reload: apache2ctl graceful","title":"Apache Web Server"},{"location":"SERVER_SETUP/#firewall","text":"The server should only publish the ports that are needed. For SORMAS this is port 80 (HTTP) and 443 (HTTPS). In addition you will need the SSH port to access the server for admin purposes. We suggest to use UFW (Uncomplicated Firewall) which provides a simple interface to iptables: sudo apt-get install ufw sudo ufw default deny incoming sudo ufw default allow outgoing sudo ufw allow ssh sudo ufw allow http sudo ufw allow https sudo ufw enable","title":"Firewall"},{"location":"SERVER_SETUP/#postfix-mail-server","text":"","title":"Postfix Mail Server"},{"location":"SERVER_SETUP/#install-postfix-and-mailutils","text":"apt install aptitude aptitude install postfix -> choose \"satelite system\" apt install mailutils","title":"Install postfix and mailutils"},{"location":"SERVER_SETUP/#configure-your-system","text":"nano /etc/aliases -> add \"root: enter-your@support-email-here.com\" nano /opt/domains/sormas/config/logback.xml -> make sure \"EMAIL_ERROR\" appender is active and sends out to your email address","title":"Configure your system"},{"location":"SERVER_SETUP/#testing-the-server-setup","text":"Use SSL Labs to test your server security config: https://www.ssllabs.com/ssltest","title":"Testing the Server Setup"},{"location":"SERVER_SETUP/#r-software-environment","text":"In order to enable disease network diagrams in the contact dashboard, R and several extension packages are required. Then the Rscript executable has to be configured in the sormas.properties file. This can be conveniently accomplished by executing the R setup script from the SORMAS ZIP archive (see SORMAS Server ): If the SORMAS installation has been customized, r-setup.sh the install paths may have to be adjusted accordingly with a text editor. Execute R setup script and follow its instructions. chmod +x r-setup.sh ./r-setup.sh","title":"R Software Environment"},{"location":"SERVER_SETUP/#sormas-to-sormas-certificate-setup","text":"To be able to communicate with other SORMAS instances, there are some additional steps which need to be taken, in order to set up the certificate and the truststore. Please see the related guide for detailed instructions regarding SORMAS to SORMAS setup.","title":"SORMAS to SORMAS Certificate Setup"},{"location":"SERVER_SETUP/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"SERVER_SETUP/#problem-login-fails","text":"Check that the users table does have a corresponding entry. If not, the database initialization that is done when deploying sormas-ear.ear probably had an error.","title":"Problem: Login fails"},{"location":"SERVER_SETUP/#problem-server-is-out-of-memory","text":"Old servers were set up with a memory size of less than 2048MB. You can change this using the following commands: /opt/payara-172/glassfish/bin/asadmin --port 6048 delete-jvm-options -Xmx512m /opt/payara-172/glassfish/bin/asadmin --port 6048 delete-jvm-options -Xmx1024m /opt/payara-172/glassfish/bin/asadmin --port 6048 create-jvm-options -Xmx2048m Alternative: You can edit the settings directly in the domain.xml in the config directory of the SORMAS domain. Just search for Xmx - there should be two entries that need to be changed.","title":"Problem: Server is out of memory"},{"location":"SERVER_UPDATE/","text":"Updating a SORMAS Server SORMAS releases starting from 1.21.0 contain a script that automatically updates and deploys the server. If you are using an older version and therefore need to do a manual server update, please download the 1.21.0 release files and use the commands specified in the server-update.sh script. Preparations Note: You can skip this step if you've just set up your SORMAS server and have already downloaded the latest release. Get the latest release files (deploy.zip) from https://github.com/hzi-braunschweig/SORMAS-Project/releases/latest Unzip the archive and copy/upload its contents to /root/deploy/sormas/$(date +%F) bash cd /root/deploy/sormas SORMAS_VERSION=1.y.z wget https://github.com/hzi-braunschweig/SORMAS-Project/releases/download/v${SORMAS_VERSION}/sormas_${SORMAS_VERSION}.zip unzip sormas_${SORMAS_VERSION}.zip mv deploy/ $(date +%F) rm sormas_${SORMAS_VERSION}.zip Automatic Server Update Navigate to the folder containing the unzipped deploy files: cd /root/deploy/sormas/$(date +%F) Make the update script executable: chmod +x server-update.sh Optional: Open server-update.sh in a text editor to customize the values for e.g. the domain path or the database name. You only need to do this if you used custom values while setting up the server. Execute the update script and follow the instructions: ./server-update.sh If anything goes wrong, open the latest update log file (by default located in the \"update-logs\" folder in the domain directory) and check it for errors. Restoring the Database If anything goes wrong during the automatic database update process when deploying the server, you can use the following command to restore the data: pg_restore --clean -U postgres -Fc -d sormas_db sormas_db_....dump Default Logins These are the default users for most user roles, intended to be used on development or demo systems. In all cases except the admin user, the username and password are identical. Make sure to deactivate them or change the passwords on productive systems. Admin Username: admin Password: sadmin Web users Surveillance Supervisor: SurvSup Case Supervisor: CaseSup Contact Supervisor: ContSup Point of Entry Supervisor: PoeSup Laboratory Officer: LabOff Event Officer: EveOff National User: NatUser National Clinician: NatClin Mobile app users Surveillance Officer: SurvOff Hospital Informant: HospInf Point of Entry Informant: PoeInf Updating Keycloak Standalone installation Upgrading from Keycloak 11 to 12 following the steps from here https://www.keycloak.org/docs/latest/upgrading/#_upgrading Stop the old server and make sure to remove any open connections to the DB Backup the DB (once the upgrade is done the old version cannot be used with the new DB version) Backup the old installation Remove ${OLD_KEYCLOAK_HOME}/standalone/data/tx-object-store/ Download the new Keycloak installation from https://www.keycloak.org/downloads Copy the ${NEW_KEYCLOAK_HOME}/standalone/ directory from the previous installation over the directory in the new installation Copy the postgres module from ${OLD_KEYCLOAK_HOME}/modules/system/layers/keycloak/org/ over to the new installation directory Copy the SORMAS themes from {OLD_KEYCLOAK_HOME}/themes/ over to the new installation directory While the new installation is stopped, run ${NEW_KEYCLOAK_HOME}/bin/jboss-cli.sh ----file=${NEW_KEYCLOAK_HOME}/bin/migrate-standalone.cli ( .bat for Windows) Start the new Keycloak installation from ${NEW_KEYCLOAK_HOME}/bin/standalone.sh ( .bat for Windows) Docker installation The docker installation is automatically upgraded to the latest version specified in the Dockerfile. Prerequisites: Make sure the DB is backed up, because once the upgrade is done the new DB won't be usable with the old version of Keycloak. For more info see the Keycloak Docker Documentation .","title":"Update"},{"location":"SERVER_UPDATE/#updating-a-sormas-server","text":"SORMAS releases starting from 1.21.0 contain a script that automatically updates and deploys the server. If you are using an older version and therefore need to do a manual server update, please download the 1.21.0 release files and use the commands specified in the server-update.sh script.","title":"Updating a SORMAS Server"},{"location":"SERVER_UPDATE/#preparations","text":"Note: You can skip this step if you've just set up your SORMAS server and have already downloaded the latest release. Get the latest release files (deploy.zip) from https://github.com/hzi-braunschweig/SORMAS-Project/releases/latest Unzip the archive and copy/upload its contents to /root/deploy/sormas/$(date +%F) bash cd /root/deploy/sormas SORMAS_VERSION=1.y.z wget https://github.com/hzi-braunschweig/SORMAS-Project/releases/download/v${SORMAS_VERSION}/sormas_${SORMAS_VERSION}.zip unzip sormas_${SORMAS_VERSION}.zip mv deploy/ $(date +%F) rm sormas_${SORMAS_VERSION}.zip","title":"Preparations"},{"location":"SERVER_UPDATE/#automatic-server-update","text":"Navigate to the folder containing the unzipped deploy files: cd /root/deploy/sormas/$(date +%F) Make the update script executable: chmod +x server-update.sh Optional: Open server-update.sh in a text editor to customize the values for e.g. the domain path or the database name. You only need to do this if you used custom values while setting up the server. Execute the update script and follow the instructions: ./server-update.sh If anything goes wrong, open the latest update log file (by default located in the \"update-logs\" folder in the domain directory) and check it for errors.","title":"Automatic Server Update"},{"location":"SERVER_UPDATE/#restoring-the-database","text":"If anything goes wrong during the automatic database update process when deploying the server, you can use the following command to restore the data: pg_restore --clean -U postgres -Fc -d sormas_db sormas_db_....dump","title":"Restoring the Database"},{"location":"SERVER_UPDATE/#default-logins","text":"These are the default users for most user roles, intended to be used on development or demo systems. In all cases except the admin user, the username and password are identical. Make sure to deactivate them or change the passwords on productive systems.","title":"Default Logins"},{"location":"SERVER_UPDATE/#admin","text":"Username: admin Password: sadmin","title":"Admin"},{"location":"SERVER_UPDATE/#web-users","text":"Surveillance Supervisor: SurvSup Case Supervisor: CaseSup Contact Supervisor: ContSup Point of Entry Supervisor: PoeSup Laboratory Officer: LabOff Event Officer: EveOff National User: NatUser National Clinician: NatClin","title":"Web users"},{"location":"SERVER_UPDATE/#mobile-app-users","text":"Surveillance Officer: SurvOff Hospital Informant: HospInf Point of Entry Informant: PoeInf","title":"Mobile app users"},{"location":"SERVER_UPDATE/#updating-keycloak","text":"","title":"Updating Keycloak"},{"location":"SERVER_UPDATE/#standalone-installation","text":"Upgrading from Keycloak 11 to 12 following the steps from here https://www.keycloak.org/docs/latest/upgrading/#_upgrading Stop the old server and make sure to remove any open connections to the DB Backup the DB (once the upgrade is done the old version cannot be used with the new DB version) Backup the old installation Remove ${OLD_KEYCLOAK_HOME}/standalone/data/tx-object-store/ Download the new Keycloak installation from https://www.keycloak.org/downloads Copy the ${NEW_KEYCLOAK_HOME}/standalone/ directory from the previous installation over the directory in the new installation Copy the postgres module from ${OLD_KEYCLOAK_HOME}/modules/system/layers/keycloak/org/ over to the new installation directory Copy the SORMAS themes from {OLD_KEYCLOAK_HOME}/themes/ over to the new installation directory While the new installation is stopped, run ${NEW_KEYCLOAK_HOME}/bin/jboss-cli.sh ----file=${NEW_KEYCLOAK_HOME}/bin/migrate-standalone.cli ( .bat for Windows) Start the new Keycloak installation from ${NEW_KEYCLOAK_HOME}/bin/standalone.sh ( .bat for Windows)","title":"Standalone installation"},{"location":"SERVER_UPDATE/#docker-installation","text":"The docker installation is automatically upgraded to the latest version specified in the Dockerfile. Prerequisites: Make sure the DB is backed up, because once the upgrade is done the new DB won't be usable with the old version of Keycloak. For more info see the Keycloak Docker Documentation .","title":"Docker installation"},{"location":"SOP_DISEASES/","text":"SOP for Adding New Diseases to SORMAS This file defines the SOP (Standard Operating Procedure) that should be followed when requesting new diseases to be added to the system by the core development team. Answering all the questions asked in this guide will make sure that we will be able to integrate new diseases into SORMAS as quickly as possible. Content SOP for Adding New Diseases to SORMAS Content Guide Step 1: Download the Data Dictionary Step 2: Define Basic Disease Details Step 3: Define Existing Case Fields Step 4: Define Existing Person Fields Step 5: Define the Relevant Symptoms Step 6: Define the Relevant Epidemiological Data Step 7: Define Health Conditions Step 8: Define New Fields in Other Areas Step 9: Provide Case Classification Criteria Step 10: Provide Additional Information Step 11: Send Your Disease Definition to the SORMAS Team Guide Step 1: Download the Data Dictionary Download the latest Data Dictionary from this repository and open it. Please never use a version of the Data Dictionary that you downloaded earlier as it is very likely that its contents have changed in the meantime. You will use the Data Dictionary to define all the details of the new disease. Please make sure to mark every addition or change (e.g. by colorizing the text or background of the row in a subtle red) so we don't miss any of the information you have provided. Step 2: Define Basic Disease Details Open the Case tab of the Data Dictionary and scroll down to the tables that have a blue background. These tables define enumerations , which are basically data types with fixed values. Examples include the different case classifications, the gender of a person or the diseases that are used in SORMAS. Find the Disease enumeration table (refer to the Type column) and add a new row to it. Enter the following details: The name of the disease in the Caption column Optionally, if the disease has a long name, a short name or abbreviation in the Short column Use the Description column to answer the following question(s): Does the disease have contact follow-up ? If yes, for how many days should contact follow-up be done? Step 3: Define Existing Case Fields Look through the rows in the first table of the Case tab (which has a grey background). This table defines all the fields that are displayed in the Case Information tab in the SORMAS application. The Caption column defines the name of the field as it is displayed in the user interface, while the Diseases column specifies which diseases use this field. Please add the name (or, if available, short name) of your new disease to the \"New disease\" column of every row that represents a field that is relevant for it and colorize it. Step 4: Define Existing Person Fields Open the Person tab and repeat step 3 for the first table containing the fields that define the details of a person in SORMAS. Step 5: Define the Relevant Symptoms Open the Symptoms tab which lists all the symptoms that are currently used in SORMAS. This is a very long list and you will have to go through every single row and define whether this symptom should be tracked for your new disease or not. It's possible that your new disease uses one or more symptoms that are currently not part of SORMAS. In that case, you need to add a new row for each of these symptoms to the bottom of the table and provide the name of the symptom in the Caption column. Most symptoms in SORMAS are simple Yes/No/Unknown fields where Yes means that the symptom is present, No that the symptom is not present and Unknown that there is no information about whether the symptom is present or not. If your symptom can simply be defined by this pattern, you don't have to specify anything else. However, if your symptom is more complex (e.g. there are a number of pre-defined values that the user should choose from), please provide all the necessary details about how the symptom should be specified by users in the Description column. Step 6: Define the Relevant Epidemiological Data Open the Epidemiological data tab which lists all fields that are used to collect information about the epidemiological background of the case, e.g. whether they visited burials, had contact with a confirmed case or animals. Repeat step 3 for all rows in the first table, and add new rows if your new disease requires information that is not currently collected within SORMAS. As new fields in this tab are likely to be more complex than basic symptoms, make sure to define as much information about how they should function in the Description column. Step 7: Define Health Conditions Open the Health conditions tab which contains a list of pre-existing conditions that are not symptoms of the disease, but are still relevant especially for case management purposes in a hospital. Repeat step 3 for all rows in the first table, and add new rows if there are health conditions relevant for your new disease that are not part of SORMAS yet. As always with new fields, make sure to provide all relevant details in the Description column. Step 8: Define New Fields in Other Areas It is possible that your disease requires further information to be collected that is not supported by SORMAS yet, e.g. new details about the person, specific information about its hospitalization, or even very important fields that should directly go into the case information. You can use the same process you used to define new symptoms, health conditions or epidemiological data fields by opening the tab in question and adding new rows to the topmost table. At this point, you have finished all the necessary definitions in the Data Dictionary. Save your work and prepare an email with the Data Dictionary file attached to it. Don't send this email before working through the remaining steps though, as there are still a few details that are needed in order to finish the specification of your new disease. Step 9: Provide Case Classification Criteria Optimally, when defining a new disease, you should also specify the criteria SORMAS should use to automatically classify the case as suspect, probable or confirmed. In order to do this in a way that is compatible with the system we use, you will need access to a running SORMAS system (e.g. the play server you can find at https://sormas.org ). Log in as any user (e.g. the default user on the play server), open the About section from the main menu, and open the Case Classification Rules (HTML) document. Please define the classification criteria in a way that is similar to the system used in this document. If available, you can also send us an official document by WHO or your national CDC that specifies the classification criteria. Step 10: Provide Additional Information If there are still things that are necessary in order to properly implement the new disease in SORMAS (you might require us to create a whole new area for cases or there might be very complex mechanics that need a lot more specification), please give us as many details about them as possible. Just put all this information into your email. Step 11: Send Your Disease Definition to the SORMAS Team Send your email containing the updated Data Dictionary file, the case classification criteria and your additional notes to sormas@helmholtz-hzi.de. Congratulations, your work is done! We should now have all the information we need in order to integrate your disease into SORMAS. If there is anything that is unclear or if we need additional details, we will get in touch with you as soon as possible. Thank you so much for contributing to SORMAS and helping us to fight the spread of as many diseases as possible!","title":"Diseases"},{"location":"SOP_DISEASES/#sop-for-adding-new-diseases-to-sormas","text":"This file defines the SOP (Standard Operating Procedure) that should be followed when requesting new diseases to be added to the system by the core development team. Answering all the questions asked in this guide will make sure that we will be able to integrate new diseases into SORMAS as quickly as possible.","title":"SOP for Adding New Diseases to SORMAS"},{"location":"SOP_DISEASES/#content","text":"SOP for Adding New Diseases to SORMAS Content Guide Step 1: Download the Data Dictionary Step 2: Define Basic Disease Details Step 3: Define Existing Case Fields Step 4: Define Existing Person Fields Step 5: Define the Relevant Symptoms Step 6: Define the Relevant Epidemiological Data Step 7: Define Health Conditions Step 8: Define New Fields in Other Areas Step 9: Provide Case Classification Criteria Step 10: Provide Additional Information Step 11: Send Your Disease Definition to the SORMAS Team","title":"Content"},{"location":"SOP_DISEASES/#guide","text":"","title":"Guide"},{"location":"SOP_DISEASES/#step-1-download-the-data-dictionary","text":"Download the latest Data Dictionary from this repository and open it. Please never use a version of the Data Dictionary that you downloaded earlier as it is very likely that its contents have changed in the meantime. You will use the Data Dictionary to define all the details of the new disease. Please make sure to mark every addition or change (e.g. by colorizing the text or background of the row in a subtle red) so we don't miss any of the information you have provided.","title":"Step 1: Download the Data Dictionary"},{"location":"SOP_DISEASES/#step-2-define-basic-disease-details","text":"Open the Case tab of the Data Dictionary and scroll down to the tables that have a blue background. These tables define enumerations , which are basically data types with fixed values. Examples include the different case classifications, the gender of a person or the diseases that are used in SORMAS. Find the Disease enumeration table (refer to the Type column) and add a new row to it. Enter the following details: The name of the disease in the Caption column Optionally, if the disease has a long name, a short name or abbreviation in the Short column Use the Description column to answer the following question(s): Does the disease have contact follow-up ? If yes, for how many days should contact follow-up be done?","title":"Step 2: Define Basic Disease Details"},{"location":"SOP_DISEASES/#step-3-define-existing-case-fields","text":"Look through the rows in the first table of the Case tab (which has a grey background). This table defines all the fields that are displayed in the Case Information tab in the SORMAS application. The Caption column defines the name of the field as it is displayed in the user interface, while the Diseases column specifies which diseases use this field. Please add the name (or, if available, short name) of your new disease to the \"New disease\" column of every row that represents a field that is relevant for it and colorize it.","title":"Step 3: Define Existing Case Fields"},{"location":"SOP_DISEASES/#step-4-define-existing-person-fields","text":"Open the Person tab and repeat step 3 for the first table containing the fields that define the details of a person in SORMAS.","title":"Step 4: Define Existing Person Fields"},{"location":"SOP_DISEASES/#step-5-define-the-relevant-symptoms","text":"Open the Symptoms tab which lists all the symptoms that are currently used in SORMAS. This is a very long list and you will have to go through every single row and define whether this symptom should be tracked for your new disease or not. It's possible that your new disease uses one or more symptoms that are currently not part of SORMAS. In that case, you need to add a new row for each of these symptoms to the bottom of the table and provide the name of the symptom in the Caption column. Most symptoms in SORMAS are simple Yes/No/Unknown fields where Yes means that the symptom is present, No that the symptom is not present and Unknown that there is no information about whether the symptom is present or not. If your symptom can simply be defined by this pattern, you don't have to specify anything else. However, if your symptom is more complex (e.g. there are a number of pre-defined values that the user should choose from), please provide all the necessary details about how the symptom should be specified by users in the Description column.","title":"Step 5: Define the Relevant Symptoms"},{"location":"SOP_DISEASES/#step-6-define-the-relevant-epidemiological-data","text":"Open the Epidemiological data tab which lists all fields that are used to collect information about the epidemiological background of the case, e.g. whether they visited burials, had contact with a confirmed case or animals. Repeat step 3 for all rows in the first table, and add new rows if your new disease requires information that is not currently collected within SORMAS. As new fields in this tab are likely to be more complex than basic symptoms, make sure to define as much information about how they should function in the Description column.","title":"Step 6: Define the Relevant Epidemiological Data"},{"location":"SOP_DISEASES/#step-7-define-health-conditions","text":"Open the Health conditions tab which contains a list of pre-existing conditions that are not symptoms of the disease, but are still relevant especially for case management purposes in a hospital. Repeat step 3 for all rows in the first table, and add new rows if there are health conditions relevant for your new disease that are not part of SORMAS yet. As always with new fields, make sure to provide all relevant details in the Description column.","title":"Step 7: Define Health Conditions"},{"location":"SOP_DISEASES/#step-8-define-new-fields-in-other-areas","text":"It is possible that your disease requires further information to be collected that is not supported by SORMAS yet, e.g. new details about the person, specific information about its hospitalization, or even very important fields that should directly go into the case information. You can use the same process you used to define new symptoms, health conditions or epidemiological data fields by opening the tab in question and adding new rows to the topmost table. At this point, you have finished all the necessary definitions in the Data Dictionary. Save your work and prepare an email with the Data Dictionary file attached to it. Don't send this email before working through the remaining steps though, as there are still a few details that are needed in order to finish the specification of your new disease.","title":"Step 8: Define New Fields in Other Areas"},{"location":"SOP_DISEASES/#step-9-provide-case-classification-criteria","text":"Optimally, when defining a new disease, you should also specify the criteria SORMAS should use to automatically classify the case as suspect, probable or confirmed. In order to do this in a way that is compatible with the system we use, you will need access to a running SORMAS system (e.g. the play server you can find at https://sormas.org ). Log in as any user (e.g. the default user on the play server), open the About section from the main menu, and open the Case Classification Rules (HTML) document. Please define the classification criteria in a way that is similar to the system used in this document. If available, you can also send us an official document by WHO or your national CDC that specifies the classification criteria.","title":"Step 9: Provide Case Classification Criteria"},{"location":"SOP_DISEASES/#step-10-provide-additional-information","text":"If there are still things that are necessary in order to properly implement the new disease in SORMAS (you might require us to create a whole new area for cases or there might be very complex mechanics that need a lot more specification), please give us as many details about them as possible. Just put all this information into your email.","title":"Step 10: Provide Additional Information"},{"location":"SOP_DISEASES/#step-11-send-your-disease-definition-to-the-sormas-team","text":"Send your email containing the updated Data Dictionary file, the case classification criteria and your additional notes to sormas@helmholtz-hzi.de. Congratulations, your work is done! We should now have all the information we need in order to integrate your disease into SORMAS. If there is anything that is unclear or if we need additional details, we will get in touch with you as soon as possible. Thank you so much for contributing to SORMAS and helping us to fight the spread of as many diseases as possible!","title":"Step 11: Send Your Disease Definition to the SORMAS Team"},{"location":"TROUBLESHOOTING/","text":"Troubleshooting Please consult this collection of solutions to common problems if you have any issues before issuing a support request or asking developers for help. Also note that this resource has only been added recently and will be extended in the future. If you have encountered (and fixed) any issue that you think would be worth adding to this list, please don't hesitate to let us know! Android Application FAQ Q: I don't see a logout option anywhere in the mobile app. How can I change my user? A: The logout option is hidden by default because users in the field often don't know their own passwords, but their devices are instead set up by a supervisor. If you want to change your user, go to the Settings screen and tap the version number five times to bring up additional options, including the logout option. Debugging Performance Problems Performance logging can be used to find out which part of the code or system might be responsible for long-running functions in the application. This helps the developers to identify the source of the problems quicker and find out whether there are several problems at once or performance problems that manifest in Java execution time instead of slow SQL queries. Caution: Do not expose any private data! Whenever you debug problems on an instance with productive data, please make sure that the logged information does not contain any personal data like real person names, birth dates, etc. to the public. Never provide such data anywhere on GitHub or any other online tool! Switch on Performance Logging in SORMAS Open the logback file located in your domain (default path: /opt/domains/sormas/config/logback.xml ) and change the log level of PerformanceLoggingInterceptor to DEBUG . The config change will be recognized during runtime within 30s. After that you will see detailed log entries in the SORMAS log. Set the log level back to its default once the logging has been done since it can reduce the overall performance of SORMAS. Log Slow SQL Queries in PostgreSQL You can enable the logging of slow SQL queries in your PostgreSQL server in postgresql.conf : Change the value of log_min_duration_statement to a value that fits your need (e.g. 10000). Restart the PostgreSQL service or reload the config. Run analysis of a SQL Query (SORMAS-Docker) You can provide an analysis of a slow running query to help the developers to see where the query is getting slow and how to fix it. SORMAS-Docker already logs slow SQL queries by default. You can view the log output on its host VM with docker logs sormas-docker_postgres_1 . Copy the SQL statement, replace all parameters ( $x ) with the values (see the following log statement) and place the SQL query on the system (outside Docker container on host): sudo bash cd /var/lib/docker/psqldata vi explain.sql # hit i (INSERT) # Paste this into the file: EXPLAIN (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) # Paste the complete SQL statement # Hit ESC and :wq to save the file Execute the SQL (inside Docker container): sudo bash docker exec -ti sormas-docker_postgres_1 bash cd /var/lib/postgresql/data su postgres psql -XqAt -d sormas -f explain.sql > analyze.json Copy the output to your home dir on the VM (not inside the Docker container) to be able to copy it from the VM to your local system: mv analyze.json /home/user.name/ Create a visual report at https://explain.dalibo.com/ in order to share the analysis. IDE Troubleshooting: Android Studio If for some reason the Android App is not building correctly (for example due to unexpected ClassNotFoundExceptions ), here is what you should try: - Clean the Project (Build -> Clean Project) - Invalidate Caches (File -> Invalidate Caches / Restart...) - Wipe your Android VM (AVD Manager -> Wipe Data) If you get this exception: Unable to load class 'javax.xml.bind.JAXBException' , the reason is most likely a faulty JDK version. For the androidapp, you need Java JDK 8. To change the JDK, go to File -> Project Structure -> JDK Location and select a valid JDK (on Linux, check the folder /usr/lib/jvm and/or install if necessary: sudo apt install openjdk-8-jdk ) IDE Troubleshooting: eclipse Deployment Problems Unfortunately, when using eclipse together with the Payara Tools, there are a number of deployment problems that you might run into. Examples of these include: ClassDefNotFoundExceptions after deploying the artifacts and logging in to the web app Error messages in eclipse telling you that the deployment failed There are a couple of things you can do to fix these problems: Do a Maven update for all projects Stop and restart the server Re-deploy the server artifacts If the problem occurred right after you've pulled new code from GitHub, your safest bet is probably to start with the Maven update. For most other problems, a simple re-deployment or, if necessary, server restart should suffice. News Feeds Polling When running eclipse with JDK 11, you might encounter the following error message: An internal error occurred during: \"Polling news feeds\". javax/xml/bind/JAXBContext . To fix it, disable Window --> Preferences --> General --> News --> \"Enable automatic news polling\" .","title":"Troubleshooting"},{"location":"TROUBLESHOOTING/#troubleshooting","text":"Please consult this collection of solutions to common problems if you have any issues before issuing a support request or asking developers for help. Also note that this resource has only been added recently and will be extended in the future. If you have encountered (and fixed) any issue that you think would be worth adding to this list, please don't hesitate to let us know!","title":"Troubleshooting"},{"location":"TROUBLESHOOTING/#android-application-faq","text":"Q: I don't see a logout option anywhere in the mobile app. How can I change my user? A: The logout option is hidden by default because users in the field often don't know their own passwords, but their devices are instead set up by a supervisor. If you want to change your user, go to the Settings screen and tap the version number five times to bring up additional options, including the logout option.","title":"Android Application FAQ"},{"location":"TROUBLESHOOTING/#debugging-performance-problems","text":"Performance logging can be used to find out which part of the code or system might be responsible for long-running functions in the application. This helps the developers to identify the source of the problems quicker and find out whether there are several problems at once or performance problems that manifest in Java execution time instead of slow SQL queries. Caution: Do not expose any private data! Whenever you debug problems on an instance with productive data, please make sure that the logged information does not contain any personal data like real person names, birth dates, etc. to the public. Never provide such data anywhere on GitHub or any other online tool!","title":"Debugging Performance Problems"},{"location":"TROUBLESHOOTING/#switch-on-performance-logging-in-sormas","text":"Open the logback file located in your domain (default path: /opt/domains/sormas/config/logback.xml ) and change the log level of PerformanceLoggingInterceptor to DEBUG . The config change will be recognized during runtime within 30s. After that you will see detailed log entries in the SORMAS log. Set the log level back to its default once the logging has been done since it can reduce the overall performance of SORMAS.","title":"Switch on Performance Logging in SORMAS"},{"location":"TROUBLESHOOTING/#log-slow-sql-queries-in-postgresql","text":"You can enable the logging of slow SQL queries in your PostgreSQL server in postgresql.conf : Change the value of log_min_duration_statement to a value that fits your need (e.g. 10000). Restart the PostgreSQL service or reload the config.","title":"Log Slow SQL Queries in PostgreSQL"},{"location":"TROUBLESHOOTING/#run-analysis-of-a-sql-query-sormas-docker","text":"You can provide an analysis of a slow running query to help the developers to see where the query is getting slow and how to fix it. SORMAS-Docker already logs slow SQL queries by default. You can view the log output on its host VM with docker logs sormas-docker_postgres_1 . Copy the SQL statement, replace all parameters ( $x ) with the values (see the following log statement) and place the SQL query on the system (outside Docker container on host): sudo bash cd /var/lib/docker/psqldata vi explain.sql # hit i (INSERT) # Paste this into the file: EXPLAIN (ANALYZE, COSTS, VERBOSE, BUFFERS, FORMAT JSON) # Paste the complete SQL statement # Hit ESC and :wq to save the file Execute the SQL (inside Docker container): sudo bash docker exec -ti sormas-docker_postgres_1 bash cd /var/lib/postgresql/data su postgres psql -XqAt -d sormas -f explain.sql > analyze.json Copy the output to your home dir on the VM (not inside the Docker container) to be able to copy it from the VM to your local system: mv analyze.json /home/user.name/ Create a visual report at https://explain.dalibo.com/ in order to share the analysis.","title":"Run analysis of a SQL Query (SORMAS-Docker)"},{"location":"TROUBLESHOOTING/#ide-troubleshooting-android-studio","text":"If for some reason the Android App is not building correctly (for example due to unexpected ClassNotFoundExceptions ), here is what you should try: - Clean the Project (Build -> Clean Project) - Invalidate Caches (File -> Invalidate Caches / Restart...) - Wipe your Android VM (AVD Manager -> Wipe Data) If you get this exception: Unable to load class 'javax.xml.bind.JAXBException' , the reason is most likely a faulty JDK version. For the androidapp, you need Java JDK 8. To change the JDK, go to File -> Project Structure -> JDK Location and select a valid JDK (on Linux, check the folder /usr/lib/jvm and/or install if necessary: sudo apt install openjdk-8-jdk )","title":"IDE Troubleshooting: Android Studio"},{"location":"TROUBLESHOOTING/#ide-troubleshooting-eclipse","text":"","title":"IDE Troubleshooting: eclipse"},{"location":"TROUBLESHOOTING/#deployment-problems","text":"Unfortunately, when using eclipse together with the Payara Tools, there are a number of deployment problems that you might run into. Examples of these include: ClassDefNotFoundExceptions after deploying the artifacts and logging in to the web app Error messages in eclipse telling you that the deployment failed There are a couple of things you can do to fix these problems: Do a Maven update for all projects Stop and restart the server Re-deploy the server artifacts If the problem occurred right after you've pulled new code from GitHub, your safest bet is probably to start with the Maven update. For most other problems, a simple re-deployment or, if necessary, server restart should suffice.","title":"Deployment Problems"},{"location":"TROUBLESHOOTING/#news-feeds-polling","text":"When running eclipse with JDK 11, you might encounter the following error message: An internal error occurred during: \"Polling news feeds\". javax/xml/bind/JAXBContext . To fix it, disable Window --> Preferences --> General --> News --> \"Enable automatic news polling\" .","title":"News Feeds Polling"},{"location":"sormas-base/doc/keycloak/","text":"Keycloak Open Source Identity and Access Management. In SORMAS Keycloak is available as an alternative authentication provider to the default authentication method. Current version is: Keycloak 12 Setup To set up Keycloak check the guide here Keycloak Setup SORMAS Realm The SORMAS Realm in Keycloak contains all the configuration which are specific to the SORMAS Project. All the configuration is part of the setup/keycloak/SORMAS.json file. Configuration summary Login & Authentication Duplicate emails are allowed in order to support the same requirement as SORMAS which in some installations require admin support for some users, in which case the admin will use her own email address No login with emails due to the previous point Password Policy comes predefined since version 1.54 of the SORMAS-Project with the following default settings Length of minimum 12 characters At least 1 upper case letter At least 1 lower case letter At least 1 digit At least 1 special character OTP is supported by default trough the Google Authenticator or Free OTP by has to be activated from the Keycloak Admin console Forgot Password is enabled by default sormas-sha256 is an encryption algorithm which comes packaged with Keycloak to support transition of existing environments towards the Keycloak Authentication Provider Clients The SORMAS Realm relies on 4 clients: sormas-ui - handles access to the SORMAS wen UI sormas-app - handles access to the SORMAS Android App sormas-rest - handles access to the SORMAS API sormas-backend - handles SORMAS server requests Roles The role management is handled by SORMAS however as a pre-validation Keycloak is also configured with a few roles which are required for certain API access: * USER - required by default for any API access * REST_USER - required for most API endpoints (main purpose is for the SurvNet converter) * REST_EXTERNAL_VISITS_USER - required by Symptom Journals which are connected to SORMAS * SORMAS_TO_SORMAS_CLIENT - required by other SORMAS instance to access the current SORMAS instance Email Email configurations are optional and are not part of the default configuration. In case the system relies on users activating their own accounts it's required to configure these settings. Custom Configuration The configuration provided by default is the minimum required configuration for Keycloak to work together with SORMAS. The Keycloak configuration can be adjusted by any user with admin rights, however beware that any change to the default configuration might render the system unusable. The following configurations are most likely to be environment specific: Email Settings make sure to set an email for the admin user, so the Test connection feature works Password Policies The Password Blacklist policy can only be configured with access to the host machine OTP Policies Can be activated by default for all user by marking Basic Auth Password+OTP as required in the Authentication>Flows section, then mark it as default in the Authentication>Required section","title":"Keycloak"},{"location":"sormas-base/doc/keycloak/#keycloak","text":"Open Source Identity and Access Management. In SORMAS Keycloak is available as an alternative authentication provider to the default authentication method. Current version is: Keycloak 12","title":"Keycloak"},{"location":"sormas-base/doc/keycloak/#setup","text":"To set up Keycloak check the guide here Keycloak Setup","title":"Setup"},{"location":"sormas-base/doc/keycloak/#sormas-realm","text":"The SORMAS Realm in Keycloak contains all the configuration which are specific to the SORMAS Project. All the configuration is part of the setup/keycloak/SORMAS.json file.","title":"SORMAS Realm"},{"location":"sormas-base/doc/keycloak/#configuration-summary","text":"","title":"Configuration summary"},{"location":"sormas-base/doc/keycloak/#login-authentication","text":"Duplicate emails are allowed in order to support the same requirement as SORMAS which in some installations require admin support for some users, in which case the admin will use her own email address No login with emails due to the previous point Password Policy comes predefined since version 1.54 of the SORMAS-Project with the following default settings Length of minimum 12 characters At least 1 upper case letter At least 1 lower case letter At least 1 digit At least 1 special character OTP is supported by default trough the Google Authenticator or Free OTP by has to be activated from the Keycloak Admin console Forgot Password is enabled by default sormas-sha256 is an encryption algorithm which comes packaged with Keycloak to support transition of existing environments towards the Keycloak Authentication Provider","title":"Login &amp; Authentication"},{"location":"sormas-base/doc/keycloak/#clients","text":"The SORMAS Realm relies on 4 clients: sormas-ui - handles access to the SORMAS wen UI sormas-app - handles access to the SORMAS Android App sormas-rest - handles access to the SORMAS API sormas-backend - handles SORMAS server requests","title":"Clients"},{"location":"sormas-base/doc/keycloak/#roles","text":"The role management is handled by SORMAS however as a pre-validation Keycloak is also configured with a few roles which are required for certain API access: * USER - required by default for any API access * REST_USER - required for most API endpoints (main purpose is for the SurvNet converter) * REST_EXTERNAL_VISITS_USER - required by Symptom Journals which are connected to SORMAS * SORMAS_TO_SORMAS_CLIENT - required by other SORMAS instance to access the current SORMAS instance","title":"Roles"},{"location":"sormas-base/doc/keycloak/#email","text":"Email configurations are optional and are not part of the default configuration. In case the system relies on users activating their own accounts it's required to configure these settings.","title":"Email"},{"location":"sormas-base/doc/keycloak/#custom-configuration","text":"The configuration provided by default is the minimum required configuration for Keycloak to work together with SORMAS. The Keycloak configuration can be adjusted by any user with admin rights, however beware that any change to the default configuration might render the system unusable. The following configurations are most likely to be environment specific: Email Settings make sure to set an email for the admin user, so the Test connection feature works Password Policies The Password Blacklist policy can only be configured with access to the host machine OTP Policies Can be activated by default for all user by marking Basic Auth Password+OTP as required in the Authentication>Flows section, then mark it as default in the Authentication>Required section","title":"Custom Configuration"},{"location":"sormas-cargoserver/","text":"SORMAS development server setup using maven-cargo This module installs a local Payara server, deploys the previously built SORMAS artifacts and starts the server. The server installation is located in the project build directory ( target/cargo ), as well as the SORMAS server directories ( target/sormasfolders ). Prerequisites This setup requires a working Java, maven, and docker(-compose) environment. Configuration The configuration of the docker setup and the payara domain setup are defined by the generated file .env . It configures port and server of the sormas-postgres docker container or another postgres database, as well as other ports defined in the domain.xml . Properties used in the payara deployment are configured in the generated file target/sormas.properties . Both .env and sormas.properties can be customized by adding a file custom.env respectively custom.properties in the project base directory, where additional properties for the respective purpose are defined. Already defined properties are overwritten. Both custom.env and custom.properties are excluded in .gitignore , so local customizations are protected from accidental commits. To run the cargo server against an existing database, configure SORMAS_POSTGRES_SERVER=<database-server> SORMAS_POSTGRES_PORT=<database-port> in file custom.env and skip the docker-compose step in the server setup (see file custom.env.example ). To add properties to the generated sormas.properties , configure e.g. custombranding=true custombranding.name=<name> custombranding.logo.path=<logopath> in file custom.properties (see file custom.properties.example ). After adjusting the configurations, (re)run mvn install and (re)start the server. Build the project (simple) The most convenient way to build and deploy the SORMAS artifacts to cargo is to use build_deploy.sh . Build the project (details) Build all SORMAS artifacts: cd sormas-base && mvn install Start SORMAS-PostgreSQL docker container cd sormas-cargoserver && docker-compose up -d Start local SORMAS server cd sormas-cargoserver && mvn cargo:run Visit Once the deployment is completed, you can navigate to http://localhost:6080/sormas-ui and login as admin with password sadmin . Stop local SORMAS server cd sormas-cargoserver && mvn cargo:stop Stop DB SORMAS-PostgreSQL docker container cd sormas-cargoserver && docker-compose down Remove docker volume (if intended) The SORMAS-PostgreSQL docker container uses a named docker volume: $ docker volume ls DRIVER VOLUME NAME local sormas-cargoserver_psqldata_cargoserver To remove this docker volume: sudo docker volume rm sormas-cargoserver_psqldata_cargoserver","title":"Cargo Server"},{"location":"sormas-cargoserver/#sormas-development-server-setup-using-maven-cargo","text":"This module installs a local Payara server, deploys the previously built SORMAS artifacts and starts the server. The server installation is located in the project build directory ( target/cargo ), as well as the SORMAS server directories ( target/sormasfolders ).","title":"SORMAS development server setup using maven-cargo"},{"location":"sormas-cargoserver/#prerequisites","text":"This setup requires a working Java, maven, and docker(-compose) environment.","title":"Prerequisites"},{"location":"sormas-cargoserver/#configuration","text":"The configuration of the docker setup and the payara domain setup are defined by the generated file .env . It configures port and server of the sormas-postgres docker container or another postgres database, as well as other ports defined in the domain.xml . Properties used in the payara deployment are configured in the generated file target/sormas.properties . Both .env and sormas.properties can be customized by adding a file custom.env respectively custom.properties in the project base directory, where additional properties for the respective purpose are defined. Already defined properties are overwritten. Both custom.env and custom.properties are excluded in .gitignore , so local customizations are protected from accidental commits. To run the cargo server against an existing database, configure SORMAS_POSTGRES_SERVER=<database-server> SORMAS_POSTGRES_PORT=<database-port> in file custom.env and skip the docker-compose step in the server setup (see file custom.env.example ). To add properties to the generated sormas.properties , configure e.g. custombranding=true custombranding.name=<name> custombranding.logo.path=<logopath> in file custom.properties (see file custom.properties.example ). After adjusting the configurations, (re)run mvn install and (re)start the server.","title":"Configuration"},{"location":"sormas-cargoserver/#build-the-project-simple","text":"The most convenient way to build and deploy the SORMAS artifacts to cargo is to use build_deploy.sh .","title":"Build the project (simple)"},{"location":"sormas-cargoserver/#build-the-project-details","text":"Build all SORMAS artifacts: cd sormas-base && mvn install","title":"Build the project (details)"},{"location":"sormas-cargoserver/#start-sormas-postgresql-docker-container","text":"cd sormas-cargoserver && docker-compose up -d","title":"Start SORMAS-PostgreSQL docker container"},{"location":"sormas-cargoserver/#start-local-sormas-server","text":"cd sormas-cargoserver && mvn cargo:run","title":"Start local SORMAS server"},{"location":"sormas-cargoserver/#visit","text":"Once the deployment is completed, you can navigate to http://localhost:6080/sormas-ui and login as admin with password sadmin .","title":"Visit"},{"location":"sormas-cargoserver/#stop-local-sormas-server","text":"cd sormas-cargoserver && mvn cargo:stop","title":"Stop local SORMAS server"},{"location":"sormas-cargoserver/#stop-db-sormas-postgresql-docker-container","text":"cd sormas-cargoserver && docker-compose down","title":"Stop DB SORMAS-PostgreSQL docker container"},{"location":"sormas-cargoserver/#remove-docker-volume-if-intended","text":"The SORMAS-PostgreSQL docker container uses a named docker volume: $ docker volume ls DRIVER VOLUME NAME local sormas-cargoserver_psqldata_cargoserver To remove this docker volume: sudo docker volume rm sormas-cargoserver_psqldata_cargoserver","title":"Remove docker volume (if intended)"},{"location":"sormas-keycloak-service-provider/","text":"Custom SORMAS Keycloak Service Provider For more information about the Service Provider Interface see: https://www.keycloak.org/docs/11.0/server_development/#_providers SORMAS Password Hash Provider This Service Provider is implementing in Keycloak a Hash Mechanism for passwords similar to the one used in SORMAS to allow migrating of credentials for already existing users. Since SORMAS and Keycloak are using different hashing techniques, the SormasPasswordHashProvider replicates the SORMAS technique by importing the sormas-api dependency where the technique is defined. SORMAS Hashing Technique For more info about the SORMAS hashing technique see sormas-api/src/main/java/de/symeda/sormas/api/utils/PasswordHelper.java In Keycloak this algorithm will be identifiable by the id sormas-sha256 . Keycloak Hashing Technique Keycloak supports a more configurable approach to password policy which can be customized for each system. See Password Policies . SORMAS User Password Sync There are only 2 ways of synchronizing the user's password from SORMAS into Keycloak: * whenever a user is created for the first time in Keycloak - being triggered from SORMAS * whenever a user's password is updated in SORMAS, and the user doesn't have an email address setup For any of the events about the user's credentials in Keycloak are overwritten by those from SORMAS, and the hashing algorithm will be changed to sormas-sha256 . However once a user chooses to change their password in Keycloak (trough the Forgot Password mechanism or by the admin), their credentials will be updated using the default or configured Password Policies from Keycloak. Deployment of the SPI To deploy the Custom SPI, make sure to build this project and then follow the steps described in Register an SPI Using the Keycloak Deployer","title":"Keycloak Service Provider"},{"location":"sormas-keycloak-service-provider/#custom-sormas-keycloak-service-provider","text":"For more information about the Service Provider Interface see: https://www.keycloak.org/docs/11.0/server_development/#_providers","title":"Custom SORMAS Keycloak Service Provider"},{"location":"sormas-keycloak-service-provider/#sormas-password-hash-provider","text":"This Service Provider is implementing in Keycloak a Hash Mechanism for passwords similar to the one used in SORMAS to allow migrating of credentials for already existing users. Since SORMAS and Keycloak are using different hashing techniques, the SormasPasswordHashProvider replicates the SORMAS technique by importing the sormas-api dependency where the technique is defined.","title":"SORMAS Password Hash Provider"},{"location":"sormas-keycloak-service-provider/#sormas-hashing-technique","text":"For more info about the SORMAS hashing technique see sormas-api/src/main/java/de/symeda/sormas/api/utils/PasswordHelper.java In Keycloak this algorithm will be identifiable by the id sormas-sha256 .","title":"SORMAS Hashing Technique"},{"location":"sormas-keycloak-service-provider/#keycloak-hashing-technique","text":"Keycloak supports a more configurable approach to password policy which can be customized for each system. See Password Policies .","title":"Keycloak Hashing Technique"},{"location":"sormas-keycloak-service-provider/#sormas-user-password-sync","text":"There are only 2 ways of synchronizing the user's password from SORMAS into Keycloak: * whenever a user is created for the first time in Keycloak - being triggered from SORMAS * whenever a user's password is updated in SORMAS, and the user doesn't have an email address setup For any of the events about the user's credentials in Keycloak are overwritten by those from SORMAS, and the hashing algorithm will be changed to sormas-sha256 . However once a user chooses to change their password in Keycloak (trough the Forgot Password mechanism or by the admin), their credentials will be updated using the default or configured Password Policies from Keycloak.","title":"SORMAS User Password Sync"},{"location":"sormas-keycloak-service-provider/#deployment-of-the-spi","text":"To deploy the Custom SPI, make sure to build this project and then follow the steps described in Register an SPI Using the Keycloak Deployer","title":"Deployment of the SPI"},{"location":"sormas-rest/","text":"REST interface for SORMAS Authentication Access to the API is restricted by HTTP Basic Authentication. You need to add a user to your instance with the REST role attached to it. Use the username and password of the REST user as credentials for your HTTP requests. API Documentation The SORMAS REST API is documented automatically. The OpenAPI specification files are generated during the build process and can be found at ${Project Root}/sormas-rest/target/swagger.{json,yaml} . You can render the OpenAPI specification with tools like editor.swagger.io . This allows you to inspect endpoints and example payloads, generate a matching API client for many languages, and to easily interact with the API of a live instance. OpenAPI / Swagger The OpenAPI files are generated with the swagger-maven-plugin and the Swagger Annotation Framework [1] . If you are only interested in the OpenAPI specification files, you may either download a recent SORMAS release where the files reside in the openapi directory, or execute the following command inside the sormas-base module's directory to build them for yourself: # Requires Maven to be installed! mvn package --projects ../sormas-rest --also-make -Dmaven.test.skip=true The specification files are created at the path specified above. [1] Swagger Annotations Guide on Github: https://github.com/swagger-api/swagger-core/wiki/Swagger-2.X---Annotations","title":"REST"},{"location":"sormas-rest/#rest-interface-for-sormas","text":"","title":"REST interface for SORMAS"},{"location":"sormas-rest/#authentication","text":"Access to the API is restricted by HTTP Basic Authentication. You need to add a user to your instance with the REST role attached to it. Use the username and password of the REST user as credentials for your HTTP requests.","title":"Authentication"},{"location":"sormas-rest/#api-documentation","text":"The SORMAS REST API is documented automatically. The OpenAPI specification files are generated during the build process and can be found at ${Project Root}/sormas-rest/target/swagger.{json,yaml} . You can render the OpenAPI specification with tools like editor.swagger.io . This allows you to inspect endpoints and example payloads, generate a matching API client for many languages, and to easily interact with the API of a live instance.","title":"API Documentation"},{"location":"sormas-rest/#openapi-swagger","text":"The OpenAPI files are generated with the swagger-maven-plugin and the Swagger Annotation Framework [1] . If you are only interested in the OpenAPI specification files, you may either download a recent SORMAS release where the files reside in the openapi directory, or execute the following command inside the sormas-base module's directory to build them for yourself: # Requires Maven to be installed! mvn package --projects ../sormas-rest --also-make -Dmaven.test.skip=true The specification files are created at the path specified above. [1] Swagger Annotations Guide on Github: https://github.com/swagger-api/swagger-core/wiki/Swagger-2.X---Annotations","title":"OpenAPI / Swagger"}]}